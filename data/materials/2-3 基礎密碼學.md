# 2-3 基礎密碼學

本章節將帶領您進入密碼學的基礎世界。密碼學是資訊安全領域的核心基石，它研究如何安全地傳輸訊息，即便通訊路徑可能被竊聽。透過學習本章，您將理解密碼學的基本目標、不同加密方法的工作原理及其應用場景。

-----

## #### 2-3.1 密碼學的核心目標

密碼學並非單純的「加密」這麼簡單，它擁有多個關鍵目標，共同構成了資訊安全的骨幹。

### ### 2-3.1.1 定義：資訊安全四大基石

1.  **機密性 (Confidentiality)**
    *   **核心觀念：** 確保資訊在未經授權的情況下不被洩露。只有合法的接收者才能讀取和理解訊息內容。
    *   **例子：** 寄送一封加密的電子郵件，即使郵件在傳輸過程中被截獲，內容也無法被竊聽者讀取。
    *   **與相鄰概念的關聯：** 這是最直觀的密碼學應用，主要透過加密演算法實現。

2.  **完整性 (Integrity)**
    *   **核心觀念：** 確保資訊在儲存或傳輸過程中，未經授權不會被修改、破壞或篡改。接收者可以驗證訊息是否在傳輸過程中被竄改。
    *   **例子：** 下載一個軟體安裝包後，透過比對其提供的雜湊值 (Hash Value) 來確認檔案在下載過程中沒有被修改。
    *   **與相鄰概念的關聯：** 通常透過雜湊函數和數位簽章來實現，與機密性目標不同，完整性不涉及隱藏內容，而是驗證內容的原始性。

3.  **身份驗證 (Authentication)**
    *   **核心觀念：** 驗證使用者、裝置或資訊來源的真實身份。確保與您通訊的對方確實是其所聲稱的身份。
    *   **例子：** 登入網路銀行時輸入帳號密碼，銀行系統會驗證您的身份；網站透過 SSL/TLS 憑證向瀏覽器證明其合法性。
    *   **與相鄰概念的關聯：** 經常與數位簽章和金鑰交換機制結合使用，以建立信任關係。

4.  **不可否認性 (Non-repudiation)**
    *   **核心觀念：** 防止發送者否認自己曾發送過某條訊息，或防止接收者否認自己曾接收過某條訊息。
    *   **例子：** 數位簽章可以證明某份電子文件是由特定的人簽署，簽署者無法否認該簽署行為。
    *   **與相鄰概念的關聯：** 主要透過數位簽章實現，是身份驗證和完整性的延伸，增加了法律上的約束力。

-----

## #### 2-3.2 對稱式密碼學 (Symmetric-Key Cryptography)

### ### 2-3.2.1 核心概念與運作原理

*   **定義：** 對稱式密碼學使用相同的金鑰來進行加密 (Encryption) 和解密 (Decryption)。這表示發送方和接收方必須共享一個共同的秘密金鑰。
*   **核心觀念：** 加密過程可表示為 $C = E_K(P)$，解密過程為 $P = D_K(C)$，其中 $P$ 是明文 (Plaintext)，$C$ 是密文 (Ciphertext)，$E_K$ 是使用金鑰 $K$ 的加密函數，$D_K$ 是使用金鑰 $K$ 的解密函數。
*   **例子：Caesar Cipher (凱薩密碼)**
    *   **推導：** 這是一種替換式密碼，將明文中的每個字母替換成字母表中固定位置之後的字母。例如，如果金鑰是 3，'A' 會變成 'D'，'B' 會變成 'E'。
    *   **加密：** `HELLO` (金鑰=3) -> `KHOOR`
    *   **解密：** `KHOOR` (金鑰=3) -> `HELLO`
    *   **與相鄰概念的關聯：** Caesar Cipher 是最簡單的對稱式密碼之一，現代的對稱式密碼演算法如 AES 則複雜得多，但核心原理（共享金鑰進行加解密）是相同的。

### ### 2-3.2.2 典型演算法與應用

*   **典型演算法：**
    *   **DES (Data Encryption Standard)：** 曾廣泛使用，但由於金鑰長度較短 (56位元)，現在被認為不安全。
    *   **3DES (Triple DES)：** 透過對資料進行三次 DES 加密來提高安全性，但效率較低。
    *   **AES (Advanced Encryption Standard)：** 目前最廣泛使用的對稱式加密標準，支援 128、192 或 256 位元金鑰長度，效率高且安全性強。
*   **應用：**
    *   大量資料的加密，例如硬碟加密 (BitLocker, VeraCrypt)。
    *   網路通訊協定中的會話金鑰加密，例如 TLS/SSL 連線的實際資料傳輸部分。
    *   需要高效能加密的場景。

-----

## #### 2-3.3 非對稱式密碼學 (Asymmetric-Key Cryptography)

### ### 2-3.3.1 核心概念與運作原理

*   **定義：** 非對稱式密碼學使用一對相關聯但不同的金鑰：**公鑰 (Public Key)** 和 **私鑰 (Private Key)**。公鑰可以公開，而私鑰必須嚴格保密。
*   **核心觀念：**
    *   用公鑰加密的資料只能用對應的私鑰解密。
    *   用私鑰加密的資料（數位簽章用途）只能用對應的公鑰解密。
    *   加密過程：$C = E_{K_{pub}}(P)$，解密過程：$P = D_{K_{priv}}(C)$。
    *   簽章過程：$S = S_{K_{priv}}(M)$，驗證過程：$V_{K_{pub}}(M, S)$。
*   **例子：RSA 演算法**
    *   **推導：** RSA (Rivest–Shamir–Adleman) 的安全性基於大數質因數分解的困難性。生成公鑰和私鑰涉及選擇兩個大質數，然後進行一系列數學運算，產生一個可公開的公鑰和一個保密的私鑰。
    *   **運作：** 假設 Alice 想向 Bob 發送秘密訊息。
        1.  Bob 生成一對公鑰/私鑰，並將公鑰發布給 Alice。
        2.  Alice 用 Bob 的公鑰加密她的訊息。
        3.  Alice 將密文發送給 Bob。
        4.  Bob 用自己的私鑰解密訊息。
    *   **與相鄰概念的關聯：** 解決了對稱式密碼學中金鑰分發的難題，因為公鑰可以公開交換而無需擔心安全問題。然而，其計算成本比對稱式高得多。

### ### 2-3.3.2 典型演算法與應用

*   **典型演算法：**
    *   **RSA：** 最廣泛使用的非對稱式演算法，可用於加密、數位簽章和金鑰交換。
    *   **ECC (Elliptic Curve Cryptography)：** 相對於 RSA，在相同安全強度下，ECC 的金鑰長度更短，計算速度更快，特別適用於資源受限的環境（如行動裝置）。
    *   **Diffie-Hellman (DH)：** 主要用於金鑰交換，允許雙方在不安全的通道上安全地建立共享秘密。
*   **應用：**
    *   **金鑰交換：** 在建立安全的對稱式加密連線之前，非對稱式加密可用於安全地交換對稱金鑰。
    *   **數位簽章：** 用於驗證訊息的來源和完整性，並提供不可否認性。
    *   **憑證認證：** SSL/TLS 憑證中就使用了非對稱式加密來驗證網站身份。
    *   **加密小量數據：** 例如加密對稱金鑰。

-----

## #### 2-3.4 雜湊函數 (Hash Functions)

### ### 2-3.4.1 核心概念與運作原理

*   **定義：** 雜湊函數是一種數學函數，它將任意長度的輸入（資料）轉換為固定長度的輸出，這個輸出稱為雜湊值 (Hash Value) 或訊息摘要 (Message Digest)。
*   **核心觀念：** 優秀的雜湊函數應具備以下特性：
    1.  **單向性 (One-way)：** 從雜湊值很難逆向推導出原始輸入。
    2.  **抗碰撞性 (Collision Resistance)：** 找到兩個不同的輸入，使其產生相同的雜湊值是非常困難的（弱抗碰撞性），且在已知一個輸入及其雜湊值的情況下，找到另一個產生相同雜湊值的輸入也是非常困難的（強抗碰撞性）。
    3.  **雪崩效應 (Avalanche Effect)：** 即使輸入只有微小的改變，也會導致雜湊值產生巨大的變化。
    4.  **定長輸出：** 無論輸入多大或多小，輸出雜湊值的長度都是固定的。
*   **例子：**
    *   輸入：`HELLO WORLD`
    *   SHA-256 雜湊值：`a591a6d40bf420404a011733cfb7b190d62c65bf0bcda32b57b277fe89f92500`
    *   輸入：`hello world` (僅大小寫不同)
    *   SHA-256 雜湊值：`b94d27b9934d3e08a52e52d7da7dabfac484efe37a5380ee9088f7ace2efcde9`
    *   **與相鄰概念的關聯：** 雜湊函數本身不提供機密性，因為它是單向的。它主要用於驗證資料完整性、儲存密碼（不儲存明文密碼，而是儲存其雜湊值）和數位簽章。

### ### 2-3.4.2 典型演算法與應用

*   **典型演算法：**
    *   **MD5 (Message Digest Algorithm 5)：** 曾廣泛使用，但已發現嚴重的碰撞漏洞，不建議用於安全性要求高的場景。
    *   **SHA-1 (Secure Hash Algorithm 1)：** 也已發現碰撞攻擊，不建議使用。
    *   **SHA-2 (Secure Hash Algorithm 2)：** 包括 SHA-256、SHA-512 等，目前被廣泛應用，安全性較高。
    *   **SHA-3 (Secure Hash Algorithm 3 / Keccak)：** 較新的標準，提供了不同於 SHA-2 的結構，作為替代方案。
*   **應用：**
    *   **資料完整性驗證：** 檢查檔案或訊息是否被篡改。
    *   **密碼儲存：** 網站儲存使用者密碼的雜湊值，而非明文。
    *   **區塊鏈 (Blockchain)：** 用於連結區塊並確保其不可篡改性。
    *   **數位簽章：** 作為簽章的輸入，縮短簽章長度並提高效率。

-----

## #### 2-3.5 數位簽章 (Digital Signatures)

### ### 2-3.5.1 核心概念與運作原理

*   **定義：** 數位簽章是一種用於驗證數位訊息或文件真實性和完整性的數學機制，它結合了非對稱式密碼學和雜湊函數。
*   **核心觀念：**
    *   **身份驗證：** 證明訊息確實來自特定的發送者。
    *   **完整性：** 證明訊息在簽署後未被修改。
    *   **不可否認性：** 發送者無法否認他們曾簽署過訊息。
*   **運作原理：**
    1.  **簽署方 (發送者) 操作：**
        *   發送者將原始訊息 $M$ 透過雜湊函數生成訊息摘要 $H(M)$。
        *   發送者使用自己的**私鑰**對訊息摘要 $H(M)$ 進行加密（或更準確地說，是簽署操作）。這就產生了數位簽章 $S = S_{K_{priv}}(H(M))$。
        *   發送者將原始訊息 $M$ 和數位簽章 $S$ 一同發送給接收者。
    2.  **驗證方 (接收者) 操作：**
        *   接收者收到訊息 $M$ 和數位簽章 $S$。
        *   接收者使用發送者的**公鑰**對數位簽章 $S$ 進行解密，得到原始的訊息摘要 $H'(M)$。
        *   接收者同時對收到的原始訊息 $M$ 獨立地進行相同的雜湊函數運算，得到新的訊息摘要 $H''(M)$。
        *   比較 $H'(M)$ 和 $H''(M)$。如果兩者完全相同，則證明訊息的完整性和發送者的身份（因為只有發送者的私鑰能生成這個簽章）。
*   **與相鄰概念的關聯：** 數位簽章是雜湊函數和非對稱式密碼學的完美結合，它提供完整性、身份驗證和不可否認性，但本身不提供機密性（因為原始訊息是明文傳輸的）。若要提供機密性，則需要額外對訊息本身進行加密。

### ### 2-3.5.2 典型演算法與應用

*   **典型演算法：**
    *   **RSA 數位簽章：** 使用 RSA 演算法來對雜湊值進行簽署和驗證。
    *   **DSA (Digital Signature Algorithm)：** 美國國家標準技術研究所 (NIST) 提出的標準數位簽章演算法。
    *   **ECDSA (Elliptic Curve Digital Signature Algorithm)：** 基於橢圓曲線密碼學的數位簽章演算法，提供更高的效率和更短的金鑰長度。
*   **應用：**
    *   **軟體發布：** 證明軟體來源可信，且未被惡意竄改。
    *   **電子郵件：** S/MIME 或 PGP 用於驗證郵件發送者和確保郵件完整性。
    *   **數位憑證 (Digital Certificates)：** 憑證本身會被憑證頒發機構 (CA) 數位簽章，以證明其合法性。
    *   **法律文件：** 提供電子文件的法律效力。

-----

## #### 2-3.6 常見錯誤與澄清

1.  **加密 (Encryption) ≠ 雜湊 (Hashing)**
    *   **澄清：** 加密是雙向的，有金鑰就能解密還原原始數據，提供機密性。雜湊是單向的，旨在生成固定長度的指紋，無法逆向還原，主要提供完整性。將密碼「雜湊」後儲存，是為了防止數據庫洩露時密碼明文外洩，但這不叫「加密密碼」。

2.  **對稱式與非對稱式加密的選擇**
    *   **澄清：** 不是說非對稱式更安全就應該都用它。非對稱式加密的計算成本遠高於對稱式加密。在實際應用中，通常會結合兩者：先用非對稱式加密安全地交換一個**對稱金鑰**，然後再用這個對稱金鑰進行高效的大量數據加密。這種組合方式稱為「混合加密系統」。

3.  **數位簽章提供機密性？**
    *   **澄清：** 數位簽章只確保訊息的來源真實性、完整性與不可否認性，訊息本身仍然是明文傳輸的。如果需要機密性，必須額外對訊息本身進行加密。

-----

## #### 2-3.7 小練習 (附詳解)

### ### 2-3.7.1 練習一：密碼學應用情境判斷

請判斷以下情境應主要使用哪種密碼學技術（對稱式加密、非對稱式加密、雜湊函數、數位簽章），並簡述原因。

1.  您正在下載一個重要的軟體安裝包，想確保它在下載過程中沒有被修改。
2.  您想給朋友發送一封秘密情書，只有他能閱讀，且通訊過程可能被監聽。
3.  一個網站需要儲存使用者的密碼，但希望即使資料庫被駭客攻破，密碼也不會直接洩露。
4.  您作為公司 CEO，需要發送一份電子公告給全體員工，證明這份公告確實是您發出的，且內容沒有被任何人修改過，防止有員工事後否認收到公告。
5.  在建立 HTTPS 連線時，瀏覽器和伺服器需要協商一個共同的秘密金鑰來加密後續通訊。

-----

### ### 2-3.7.2 練習一：詳解

1.  **情境：** 下載軟體安裝包，確保完整性。
    *   **技術：雜湊函數**
    *   **原因：** 雜湊函數能為檔案生成唯一的「數位指紋」。使用者可以將下載的檔案雜湊值與官方提供的雜湊值進行比對，若兩者一致，則證明檔案在傳輸過程中沒有被竄改。

2.  **情境：** 發送秘密情書，只有朋友能閱讀，提供機密性。
    *   **技術：對稱式加密**（用於實際訊息加密）與**非對稱式加密**（用於安全交換對稱金鑰）的組合，即**混合加密系統**。
    *   **原因：** 為了確保機密性，需要加密訊息。由於情書內容可能很長，使用效率更高的對稱式加密是首選。但如何安全地將對稱金鑰分享給朋友是個問題，這就需要用非對稱式加密來交換這個對稱金鑰。

3.  **情境：** 網站儲存使用者密碼，防止密碼洩露。
    *   **技術：雜湊函數** (通常會加上加鹽 (Salting) 機制)
    *   **原因：** 網站不應該儲存使用者密碼的明文。透過雜湊函數，將使用者輸入的密碼轉換成雜湊值後再儲存。當使用者登入時，系統會對其輸入的密碼再次雜湊，並與儲存的雜湊值比對。即使雜湊值被駭客獲取，由於雜湊函數的單向性，也很難反推出原始密碼。

4.  **情境：** CEO 發送電子公告，證明來源、完整性、不可否認性。
    *   **技術：數位簽章**
    *   **原因：** 數位簽章完美符合這三個要求：CEO 使用自己的私鑰對公告的雜湊值進行簽章，員工用 CEO 的公鑰驗證簽章。這證明公告確實由 CEO 發出（身份驗證），內容未被修改（完整性），且 CEO 無法否認（不可否認性）。

5.  **情境：** HTTPS 連線中，瀏覽器和伺服器協商共享秘密金鑰。
    *   **技術：非對稱式加密** (通常是 Diffie-Hellman 或 RSA 金鑰交換)
    *   **原因：** 在不安全的網路通道上，首次建立安全連線時，雙方需要交換一個共同的秘密對稱金鑰。非對稱式加密的金鑰交換機制允許雙方安全地達成這個目的，即使有竊聽者也無法得知該金鑰。一旦對稱金鑰建立，後續的實際數據傳輸就會使用效率更高的對稱式加密。

-----

## #### 2-3.8 延伸閱讀

*   **《應用密碼學》(Applied Cryptography)** by Bruce Schneier：密碼學領域的經典之作，深入淺出地介紹了各種加密演算法和協議。
*   **NIST Cryptographic Standards and Guidelines：** 美國國家標準與技術研究院發布的密碼學標準，包含了 AES、SHA 系列等演算法的詳細規範。
    *   [https://csrc.nist.gov/](https://csrc.nist.gov/)
*   **Diffie-Hellman Key Exchange Explained：** 理解非對稱金鑰交換原理的入門文章。
    *   [https://www.cloudflare.com/learning/ssl/what-is-diffie-hellman/](https://www.cloudflare.com/learning/ssl/what-is-diffie-hellman/) (英文資源，但解釋很清楚)