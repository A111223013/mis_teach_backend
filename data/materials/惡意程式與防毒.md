# 3-3 惡意程式與防毒

## ### 1. 核心概念與定義

#### #### 1.1 惡意程式 (Malware)

*   **定義/核心觀念**：
    惡意程式 (Malicious Software, 簡稱 Malware) 泛指所有旨在未經使用者同意下，對電腦系統、網路或數據造成損害、入侵或不法操作的軟體。其目的可能包括竊取資料、破壞系統、勒索金錢、顯示廣告等。
*   **例子**：
    您可能聽過病毒、蠕蟲、木馬、勒索軟體、間諜軟體等，這些都是常見的惡意程式類型。例如，一個看似無害的遊戲程式，在背景默默記錄您的鍵盤輸入並傳送給駭客，這就是一種惡意程式行為。
*   **與相鄰概念的關聯**：
    惡意程式是一個廣泛的統稱，包含了各種具備惡意目的的軟體，而病毒、蠕蟲、木馬等則是其下的具體分類，各自有不同的傳播方式與行為模式。

-----

#### #### 1.2 防毒軟體 (Antivirus Software)

*   **定義/核心觀念**：
    防毒軟體 (Antivirus Software) 是一種用於偵測、預防、隔離及移除電腦系統中惡意程式的應用程式。它旨在保護電腦及其儲存的數據免受惡意程式的侵害。
*   **例子**：
    市面上常見的防毒軟體有 Avast、Kaspersky、Norton、Bitdefender 等。許多作業系統也內建了防毒功能，如 Windows Defender。
*   **與相鄰概念的關聯**：
    防毒軟體是應對惡意程式威脅的主要工具之一。它與惡意程式是矛與盾的關係，防毒軟體不斷演進以對抗日益複雜的惡意程式。

-----

## ### 2. 典型惡意程式類型

惡意程式有許多種類，以下介紹幾種最常見的類型：

#### #### 2.1 病毒 (Virus)

*   **定義/核心觀念**：
    病毒是一種自我複製的程式碼，它會依附在合法程式、文件或其他可執行檔上。當被感染的程式被執行時，病毒便會啟動並嘗試感染其他程式，造成系統損壞或資料遺失。**病毒的傳播需要宿主程式的執行。**
*   **例子**：
    早期的檔案型病毒或巨集病毒 (Macro Virus)，它們可以感染 Word 文件或 Excel 試算表，當使用者開啟文件時便會被感染。
*   **與相鄰概念的關聯**：
    與蠕蟲不同，病毒通常需要一個「宿主」才能傳播，且需要使用者執行宿主程式才能啟動。

-----

#### #### 2.2 蠕蟲 (Worm)

*   **定義/核心觀念**：
    蠕蟲是一種獨立運作的惡意程式，它能夠**自我複製並透過網路自行傳播**，無需依附在其他程式上，也不需要使用者執行便可感染其他系統。它們通常利用系統漏洞或網路共享進行傳播。
*   **例子**：
    著名的 WannaCry 勒索蠕蟲，利用 Windows 的 SMB 漏洞在全球範圍內迅速傳播，造成大量電腦被加密。
*   **與相鄰概念的關聯**：
    與病毒最大的區別在於，蠕蟲是獨立的程式，不需宿主，且能主動透過網路傳播。

-----

#### #### 2.3 特洛伊木馬 (Trojan Horse)

*   **定義/核心觀念**：
    特洛伊木馬是一種惡意程式，它**偽裝成有用的、無害的或受歡迎的應用程式**，誘騙使用者下載並執行。一旦被執行，木馬會在背景執行惡意功能，但不會自我複製。
*   **例子**：
    一個看似提供免費軟體的網站，您下載了一個應用程式，安裝後發現它除了提供聲稱的功能外，還在您不知情的情況下開啟了後門，讓駭客可以遠端操控您的電腦。
*   **與相鄰概念的關聯**：
    木馬不具備自我複製能力（與病毒和蠕蟲不同），其主要攻擊手法是「偽裝」和「誘騙」。

-----

#### #### 2.4 勒索軟體 (Ransomware)

*   **定義/核心觀念**：
    勒索軟體是一種特殊類型的惡意程式，它會**加密受害者的檔案或鎖定整個電腦系統**，然後要求受害者支付贖金（通常是加密貨幣），才能解密檔案或解除系統鎖定。
*   **例子**：
    NotPetya 和 Ryuk 是兩種知名的勒索軟體，對全球企業造成了巨大的經濟損失。
*   **與相鄰概念的關聯**：
    勒索軟體是一種結合了加密技術和社交工程（誘騙使用者執行）的惡意程式，其「商業模式」是其獨特之處。它可能透過木馬、蠕蟲或釣魚郵件傳播。

-----

#### #### 2.5 間諜軟體 (Spyware)

*   **定義/核心觀念**：
    間諜軟體是一種在使用者不知情或未經同意的情況下，**秘密收集使用者資訊並傳送給第三方**的程式。收集的資訊可能包括鍵盤輸入（鍵盤側錄）、瀏覽歷史、個人檔案、截圖等。
*   **例子**：
    一些惡意的免費軟體，可能在安裝時捆綁間諜軟體，追蹤您的線上活動並將數據回傳。
*   **與相鄰概念的關聯**：
    間諜軟體的目的在於「竊取資訊」，而非直接破壞系統。它常常與廣告軟體、木馬或後門程式結合。

-----

#### #### 2.6 廣告軟體 (Adware)

*   **定義/核心觀念**：
    廣告軟體是一種會**強制顯示廣告，或將使用者瀏覽器重新導向到特定網站**的程式。有些廣告軟體會伴隨間諜行為，收集使用者偏好以提供更精準的廣告。
*   **例子**：
    您瀏覽網頁時不斷跳出彈窗廣告，或瀏覽器首頁被修改成某個不明網站，且無法自行更改。
*   **與相鄰概念的關聯**：
    廣告軟體主要目的在於透過廣告獲利，但過度或未經同意的廣告行為，以及可能附帶的間諜功能，使其被歸類為惡意程式。

-----

## ### 3. 防毒軟體運作原理

防毒軟體主要透過以下幾種技術來偵測和防禦惡意程式：

#### #### 3.1 病毒碼比對 (Signature-based Detection)

*   **定義/核心觀念**：
    這是最傳統且有效的偵測方式。防毒軟體會維護一個巨大的「病毒碼資料庫」，其中包含已知惡意程式的獨特位元組序列或特徵碼。當掃描檔案時，防毒軟體會比對檔案內容與資料庫中的病毒碼。如果匹配，則判定為已知惡意程式。
*   **例子**：
    防毒軟體更新了最新的勒索軟體病毒碼，下次掃描時，若發現您的電腦中有檔案符合該勒索軟體的特徵，就會發出警報並處理。
*   **優點**：偵測準確度高，誤報率低。
*   **缺點**：只能偵測已知的惡意程式。對於全新的、變種的或「零日攻擊」則束手無策。

-----

#### #### 3.2 啟發式分析 (Heuristic Analysis)

*   **定義/核心觀念**：
    為彌補病毒碼比對的不足，啟發式分析不依賴於特定的病毒碼，而是透過**分析程式碼結構、指令序列或行為模式**，來判斷一個檔案是否具有惡意意圖。例如，一個程式試圖直接寫入作業系統核心區域或頻繁修改其他程式，就可能被啟發式分析判定為可疑。
*   **例子**：
    防毒軟體發現一個從未見過的程式，但它執行了類似蠕蟲的自我複製指令，並嘗試對網路上的其他電腦發送大量封包。即便沒有病毒碼，啟發式分析也會將其標記為惡意。
*   **優點**：能夠偵測未知的新型惡意程式或變種。
*   **缺點**：可能會有較高的誤報率，因為某些合法程式的行為也可能被誤判為惡意。

-----

#### #### 3.3 行為監控 (Behavior Monitoring)

*   **定義/核心觀念**：
    行為監控是在程式運行時，**即時監測其行為**。防毒軟體會觀察程式是否進行了如修改註冊表、寫入系統核心檔案、開啟異常網路連線、加密大量檔案等可疑操作。一旦發現異常行為，立即阻止並警報。
*   **例子**：
    當一個程式嘗試加密您電腦上的所有文件時，防毒軟體的行為監控模組會立即阻止這個行為，並將該程式隔離。
*   **優點**：可以有效阻止正在進行中的惡意行為，對零日攻擊具有較好的防禦能力。
*   **缺點**：可能會消耗較多系統資源；某些合法行為也可能被誤判或干擾。

-----

#### #### 3.4 沙盒技術 (Sandbox)

*   **定義/核心觀念**：
    沙盒技術是在一個**隔離的、虛擬的環境中執行可疑程式**，觀察其行為。這個環境與真實的作業系統完全分離，程式在其中所做的任何操作都不會影響到真實系統。防毒軟體會記錄程式在沙盒中的行為，然後判斷其是否為惡意。
*   **例子**：
    當您收到一個可疑的電子郵件附件時，防毒軟體可能會先將其在沙盒中執行，如果附件嘗試感染系統，沙盒會捕捉到這些惡意行為，而不會危害到您的真實電腦。
*   **優點**：極高的安全性，可以完整地分析惡意程式而不冒險。
*   **缺點**：分析過程可能需要時間，且會消耗一定的系統資源。

-----

#### #### 3.5 雲端技術 (Cloud-based Analysis)

*   **定義/核心觀念**：
    雲端防毒是將惡意程式分析和病毒碼更新的負擔轉移到雲端伺服器上。當遇到可疑檔案時，防毒軟體會將其特徵或部分內容上傳至雲端進行快速比對和分析。雲端伺服器擁有強大的計算能力和即時更新的威脅情報。
*   **例子**：
    當您的防毒軟體掃描到一個陌生檔案時，它會向雲端發送查詢，雲端服務可能瞬間比對數十億個威脅簽名和行為模式，並迅速返回結果。
*   **優點**：病毒碼更新速度快，能即時防禦最新威脅；本地電腦資源消耗較少；能利用大數據分析威脅趨勢。
*   **缺點**：需要持續的網路連線；部分使用者可能對數據隱私有疑慮。

-----

## ### 4. 惡意程式防護策略

要有效防禦惡意程式，需要綜合運用多種策略：

#### #### 4.1 個人電腦防護

1.  **安裝並定期更新防毒軟體**：這是最基本的防護措施，確保病毒碼和偵測引擎保持最新。
2.  **更新作業系統與應用程式**：軟體漏洞是惡意程式入侵的主要途徑，及時安裝更新檔能修補這些漏洞。
3.  **啟用防火牆**：防火牆可以監控並限制網路流量，防止未經授權的程式連線外部網路或外部攻擊。
4.  **警惕不明連結與附件**：不點擊來自不明來源的電子郵件連結、簡訊連結，不開啟不明附件，特別是壓縮檔或可執行檔。
5.  **定期備份重要資料**：將重要檔案備份到外部儲存裝置或雲端服務，即使遭到勒索軟體攻擊也能恢復。
6.  **使用強密碼並啟用雙因子驗證 (2FA)**：防止帳號被盜用。
7.  **審慎安裝軟體**：只從官方或可靠來源下載軟體，避免安裝捆綁了惡意程式的免費軟體。
8.  **瀏覽器安全設定**：啟用瀏覽器的安全功能，如阻止彈出視窗、啟用安全瀏覽模式。

#### #### 4.2 企業/組織防護 (進階內容)

1.  **建立完善的資安政策**：規範員工的資安行為準則。
2.  **員工資安意識訓練**：定期對員工進行釣魚郵件演練和資安教育，提升防護意識。
3.  **部署網路安全設備**：如入侵偵測系統 (IDS) 或入侵防禦系統 (IPS)、安全閘道、行為分析系統等。
4.  **數據加密**：對敏感數據進行加密，即使資料被竊取，也能降低洩漏風險。
5.  **災難復原計畫**：制定詳細的備份與復原策略，在遭受重大攻擊時能迅速恢復運作。
6.  **最小權限原則**：使用者和應用程式只被賦予完成其工作所需的最低權限。
7.  **資安監控中心 (SOC)**：建立或委託專業團隊進行 24/7 的資安監控與事件回應。

-----

## ### 5. 常見錯誤與澄清

#### #### 5.1 「我的 Mac/Linux 不會中毒！」

*   **澄清**：這是一個常見的迷思。雖然惡意程式多數針對 Windows 系統，但 Mac 和 Linux 系統並非免疫。隨著這些系統使用者數量增加，針對它們的惡意程式也越來越多，例如 Mac 上的勒索軟體或廣告軟體，Linux 上的伺服器攻擊蠕蟲。所有作業系統都有漏洞，都需要防護。

#### #### 5.2 「裝了防毒軟體就萬無一失了！」

*   **澄清**：防毒軟體是重要的第一道防線，但它並非萬能。再好的防毒軟體也無法百分之百偵測到所有威脅，特別是針對新型變種或零日攻擊。使用者自身的安全習慣（如不點擊可疑連結、不下載不明檔案）同樣重要，因為許多惡意程式是透過「社交工程」來誘騙使用者執行的。

#### #### 5.3 病毒、蠕蟲、木馬常常搞混？

*   **澄清**：
    *   **病毒 (Virus)**：需要依附在其他程式上，且需要執行宿主程式才會感染。
    *   **蠕蟲 (Worm)**：獨立的惡意程式，可自我複製並透過網路自行傳播，不需宿主。
    *   **木馬 (Trojan Horse)**：偽裝成有用程式，誘騙使用者執行，但不具備自我複製能力。
    這些是不同傳播方式和行為模式的惡意程式類型。

-----

## ### 6. 小練習 (附詳解)

#### #### 小練習 1：惡意程式類型辨識

請閱讀以下情境，判斷使用者可能遭遇到哪種類型的惡意程式攻擊，並簡述原因。

**情境 A**：小明收到一封來自「銀行」的電子郵件，郵件中提示他的帳戶有異常活動，要求他點擊連結登入驗證。小明不疑有他點擊了連結，進入一個看似與銀行官網一模一樣的網頁，並輸入了帳號密碼。幾天後，他發現銀行帳戶裡的錢被盜轉了。

**情境 B**：小華在網路上看到一個提供「免費破解版遊戲」的網站，他興奮地下載並安裝了該遊戲。遊戲確實可以玩，但沒過多久，他的電腦開始變得非常卡頓，螢幕上不斷彈出各種廣告，瀏覽器的首頁也變成了一個奇怪的購物網站，且無法修改。

**情境 C**：小王公司的內部網路突然出現大量異常流量，許多電腦的檔案都被加密，文件名稱變成了亂碼，桌面顯示一個倒數計時器，要求公司支付比特幣才能解密檔案，否則檔案將永久丟失。資安部門發現，攻擊是透過公司網路中一台未修補的舊伺服器漏洞傳播開來的。

---

**詳解**

*   **情境 A**：
    *   **惡意程式類型**：釣魚攻擊 (Phishing) 結合後續的資料竊取（可能是木馬或間諜軟體）。
    *   **原因**：這是一個典型的釣魚攻擊，駭客偽裝成銀行，誘騙使用者在假網站輸入敏感資訊。一旦資訊被竊取，可能被用來登入真實帳戶進行盜轉。雖然主要攻擊方式是社交工程，但如果假網站下載了程式到小明電腦，那也可能是木馬或間諜軟體的一部分。

*   **情境 B**：
    *   **惡意程式類型**：特洛伊木馬 (Trojan Horse) 結合廣告軟體 (Adware) 或間諜軟體 (Spyware)。
    *   **原因**：該「免費遊戲」是偽裝成有用程式的木馬，在其背景偷偷安裝了惡意模組。電腦卡頓、廣告彈出、瀏覽器首頁被修改是典型的廣告軟體行為；如果同時監控小華的行為，則可能也包含間諜軟體。

*   **情境 C**：
    *   **惡意程式類型**：勒索軟體 (Ransomware) 結合蠕蟲 (Worm) 的傳播方式。
    *   **原因**：檔案被加密並要求支付贖金是勒索軟體的典型特徵。而攻擊是透過「未修補的舊伺服器漏洞傳播開來」，且影響「許多電腦」，這表明它具有蠕蟲的自我複製和網路傳播能力。WannaCry 等勒索蠕蟲就是這樣的組合。

-----

#### #### 小練習 2：防毒軟體偵測原理應用

假設您是某防毒軟體公司的工程師，現在遇到一個全新的惡意程式變種，該程式會偷偷修改系統的核心檔案，並嘗試對網路上的其他電腦進行掃描和連接。公司的病毒碼資料庫中還沒有這個變種的任何資訊。

請您根據上述資訊，列出您會優先使用哪兩種防毒軟體的偵測原理來應對這個新威脅，並簡述為什麼。

---

**詳解**

1.  **優先使用的偵測原理一：啟發式分析 (Heuristic Analysis)**
    *   **原因**：這個惡意程式是「全新的變種」，公司的「病毒碼資料庫中還沒有這個變種的任何資訊」。因此，基於病毒碼比對的方法將無法偵測到它。啟發式分析不依賴已知特徵碼，而是分析程式的行為模式和指令結構，可以偵測到未知的新威脅。該惡意程式「修改系統的核心檔案」和「嘗試對網路上的其他電腦進行掃描和連接」都是典型的惡意行為模式，啟發式分析能夠捕捉到這些行為。

2.  **優先使用的偵測原理二：行為監控 (Behavior Monitoring)**
    *   **原因**：行為監控可以在程式「執行時」即時偵測和阻止可疑行為。這個惡意程式會「修改系統的核心檔案」和「嘗試對網路上的其他電腦進行掃描和連接」，這些都是非常明顯且具有破壞性的行為。行為監控可以立即察覺這些正在進行的惡意操作，並在造成實質損害之前予以阻止，提供即時的防護。

-----

## ### 7. 延伸閱讀/參考

*   **OWASP Top 10**：由開放全球應用程式安全專案 (Open Web Application Security Project) 發布的 Web 應用程式十大最嚴重安全風險列表，雖然更偏重 Web 安全，但許多概念也與惡意程式攻擊有交集。
    *   [https://owasp.org/www-project-top-ten/](https://owasp.org/www-project-top-ten/)
*   **資安新聞與部落格**：
    *   趨勢科技資安部落格 ([https://www.trendmicro.com/zh_tw/research/security-blog.html](https://www.trendmicro.com/zh_tw/research/security-blog.html))
    *   資安人 (iThome Security) ([https://www.ithome.com.tw/security](https://www.ithome.com.tw/security))
*   **相關書籍**：
    *   《電腦網路與網路安全》相關大學教科書
    *   《惡意程式分析實戰》

