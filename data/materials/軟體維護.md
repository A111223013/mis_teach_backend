### 6-2 軟體維護

#### 1. 核心概念與定義

##### 什麼是軟體維護？

**定義：** 軟體維護是指在軟體交付給用戶後，為了修正錯誤、提升性能、適應環境變化或增加新功能而對軟體所進行的修改活動。它不只是「修復錯誤」，更是軟體生命週期中一個持續且不可或缺的階段，通常佔據軟體總成本的極大部分。

**核心觀念：**
*   **持續性：** 軟體維護不是一次性任務，而是伴隨軟體整個生命週期的持續過程。
*   **廣泛性：** 維護範疇遠超過錯誤修復，涵蓋了軟體功能、性能、可靠性、可用性等方面的改進。
*   **重要性：** 良好的維護能確保軟體長期穩定運行，滿足用戶需求，並延長軟體的使用壽命。

-----

##### 維護的必要性

軟體之所以需要維護，是因為軟體運行環境、用戶需求和業務邏輯會不斷演變，且初始開發階段難以預見所有問題。

**必要性推導：**
1.  **環境變化：** 作業系統更新、資料庫升級、硬體架構改變、網路協議演進等外部因素，都可能導致軟體需要調整以維持兼容性或優化性能。
2.  **需求演進：** 用戶在實際使用中會發現新的需求，或原有需求隨業務發展而變化。
3.  **錯誤發現：** 儘管經過嚴格測試，複雜軟體系統在實際運行中仍可能出現未被發現的錯誤或異常情況。
4.  **性能優化：** 隨著數據量增加或用戶數增長，軟體可能需要進行性能調優以保持響應速度。
5.  **技術債務：** 初期為了快速上線或資源限制而採取的非最佳實踐，會在後期累積成技術債務，需要維護來償還。

-----

##### 維護的類型

根據修改的目的，軟體維護通常分為以下四種類型。理解這些類型對於規劃維護策略和分配資源至關重要。

**1. 更正性維護 (Corrective Maintenance)**

*   **定義：** 專門用於偵測、診斷並修復軟體中已發現的錯誤、缺陷或故障。這些錯誤可能是邏輯錯誤、編碼錯誤、設計錯誤或集成錯誤，導致軟體無法正常運行或產生不正確的結果。
*   **例子：**
    *   用戶報告系統在特定操作下崩潰。
    *   計算結果與預期不符，經查是某個公式編寫錯誤。
    *   網頁加載速度異常緩慢，發現是資料庫查詢語句效率低下導致的死鎖。
*   **與相鄰概念的關聯：** 與軟體測試和品質保證緊密相關。測試旨在發現錯誤，而更正性維護則是修復這些錯誤。良好的錯誤報告機制和追蹤系統是高效進行更正性維護的基礎。

**2. 適應性維護 (Adaptive Maintenance)**

*   **定義：** 為了使軟體能夠適應其運行環境的變化而進行的修改。這些變化通常來自於外部因素，而非軟體本身的錯誤。
*   **例子：**
    *   作業系統升級到新版本，軟體需要調整以確保兼容性。
    *   資料庫管理系統升級，軟體連接資料庫的驅動程式或配置需要更新。
    *   第三方服務API變更，軟體需要修改以繼續與其互動。
    *   為符合新的法規要求，例如數據隱私法規（GDPR、個資法），需要調整數據處理邏輯。
*   **與相鄰概念的關聯：** 與系統集成和環境管理密切相關。軟體的開放性、可配置性和模組化設計能有效降低適應性維護的複雜度。

**3. 完善性維護 (Perfective Maintenance)**

*   **定義：** 為了改進軟體的性能、可維護性、可用性、安全性或增加新功能而進行的修改。這類維護是為了提高軟體的整體價值，使其更能滿足用戶不斷變化的需求。
*   **例子：**
    *   根據用戶回饋，增加一個新的報表生成功能。
    *   優化現有演算法，縮短某些計算任務的處理時間。
    *   重新設計用戶界面，使其更直觀、易於使用。
    *   重構部分程式碼，提高可讀性和模組化程度，降低未來維護的難度。
    *   強化安全措施，修補潛在的漏洞。
*   **與相鄰概念的關聯：** 與需求工程、用戶體驗 (UX) 設計、軟體重構和軟體演進緊密相連。完善性維護通常是主動的，旨在提升軟體在市場上的競爭力。

**4. 預防性維護 (Preventive Maintenance)**

*   **定義：** 在軟體出現問題之前，主動地對軟體進行修改，以降低未來發生錯誤的可能性、提升其穩定性或延長其使用壽命。
*   **例子：**
    *   定期審查程式碼，識別潛在的錯誤模式或低效率代碼，並進行重構。
    *   更新過時的第三方函式庫或框架，以避免其已知漏洞或未來兼容性問題。
    *   增加日誌記錄和監控功能，以便在問題發生前預警。
    *   優化資料庫結構或索引，以預防未來性能瓶頸。
*   **與相鄰概念的關聯：** 與軟體設計原則（如低耦合、高內聚）、程式碼審查、自動化測試和技術債務管理息息相關。預防性維護是降低長期維護成本和風險的有效策略。

-----

#### 2. 典型例子與情境分析

為了更具體地理解軟體維護的類型，我們來看一些真實世界的情境。

**情境一：電子商務平台**

一家電子商務平台在雙十一購物節後，陸續收到客戶投訴，反映部分訂單的實際支付金額與顯示金額不符。經過工程師調查，發現是優惠券折扣邏輯在處理多個商品且同時使用特定類型優惠券時出現計算錯誤。

*   **維護類型：** **更正性維護**。這是因為系統出現了錯誤導致功能不正常。

**情境二：企業內部管理系統**

某企業內部管理系統運行在舊版的Windows Server 2012 R2上。由於微軟即將停止對該版本的技術支援，IT部門決定將伺服器升級到Windows Server 2022。升級後，管理系統的某些組件無法正常啟動。

*   **維護類型：** **適應性維護**。軟體需要調整以適應新的操作系統環境。

**情境三：行動銀行App**

一家銀行推出了全新的行動銀行App，用戶反應App界面雖然美觀，但某些常用功能的入口層級過深，操作不便，影響了用戶體驗。銀行決定根據用戶回饋重新設計導航結構，並增加指紋登入功能。

*   **維護類型：** **完善性維護**。目的是提升用戶體驗和增加新功能。

**情境四：大數據分析平台**

一個運行多年的大數據分析平台，其程式碼基於較老的Python 2版本。團隊預見到未來Python 2將不再維護，且許多新的資料科學函式庫已全面轉向Python 3。為了避免未來出現兼容性問題和利用新函式庫的優勢，團隊計畫將整個平台的核心代碼從Python 2遷移到Python 3。

*   **維護類型：** **預防性維護**。在問題發生前，主動升級技術棧以避免未來可能的問題並提升潛力。

-----

#### 3. 與相鄰概念的關聯

軟體維護並非獨立存在，它與整個軟體工程領域的許多其他概念緊密相關。

**1. 與軟體開發生命週期 (SDLC) 的關聯：**
    *   維護是SDLC的最後一個階段，但同時也是一個循環的過程。
    *   開發階段的決策（如設計、編碼、測試）會直接影響維護階段的成本和複雜性。良好的前期工作能顯著降低後續維護的負擔。
    *   維護階段發現的問題和收集到的需求，又會反饋到SDLC的早期階段，驅動軟體的下一輪迭代或新版本開發。

**2. 與軟體品質 (Software Quality) 的關聯：**
    *   軟體品質的許多屬性（如可靠性、效率、可用性、可維護性）都是通過維護活動來實現和提升的。
    *   更正性維護直接修復影響品質的缺陷；適應性維護確保品質在環境變化下得以保持；完善性維護直接提升了品質屬性；預防性維護則防範品質下降。
    *   可維護性本身就是軟體品質的一個重要屬性。

**3. 與文件 (Documentation) 的關聯：**
    *   清晰、完整且即時更新的軟體文件（需求文件、設計文件、程式碼註解、測試報告、操作手冊）是高效維護的基石。
    *   缺乏文件會導致維護人員難以理解系統，增加錯誤修復時間，提高適應和完善的難度。
    *   維護活動本身也應更新相關文件，保持其同步性。

**4. 與版本控制 (Version Control) 的關聯：**
    *   版本控制系統（如Git）是軟體維護不可或缺的工具。
    *   它能夠追蹤每一次程式碼修改的歷史，方便回溯、比對和合併。
    *   在進行更正性或完善性維護時，版本控制能確保修改的可追溯性和團隊協作的順暢。

**5. 與技術債務 (Technical Debt) 的關聯：**
    *   技術債務是指為了加速開發而犧牲軟體品質或最佳實踐所累積的「欠債」。
    *   積累的技術債務會增加後續維護的難度和成本。
    *   完善性維護和預防性維護通常包含「償還技術債務」的活動，如重構、代碼清理、更新過時組件等。

-----

#### 4. 進階內容

##### 維護成本與「80/20 法則」

**核心觀念：** 軟體維護階段的成本往往佔軟體總成本的極大部分。許多研究和經驗法則指出，軟體維護費用通常佔據軟體生命週期總成本的 50% 到 90% 之間，遠高於初始開發成本。這點常被初學者忽視。

**80/20 法則 (Pareto Principle) 在維護中的應用：**
這個原則在軟體維護中常有兩種解讀：
1.  **問題分布：** 大約 80% 的軟體問題是由 20% 的程式碼模組引起的。這意味著，將精力集中在最常出錯或最複雜的模組上，可以有效地提升維護效率。
2.  **資源分配：** 80% 的維護成本用於 20% 的功能或模組，或 80% 的維護時間花費在 20% 的改動上。這提醒我們應優化高頻變更區域的程式碼質量和設計。

**推導：** 高昂的維護成本主要源於：
*   理解現有系統的複雜性。
*   在缺乏良好文件的情況下進行修改。
*   修改可能引入新的錯誤 (「打地鼠」效應)。
*   不斷適應新環境和滿足新需求的壓力。
*   老舊系統缺乏現代化工具支援。

-----

##### 可維護性 (Maintainability)

**定義：** 可維護性是指軟體能夠被修改以糾正缺陷、滿足新需求、適應新環境或執行預防性修改的容易程度。它是軟體品質的一個關鍵屬性。

**核心觀念：**
*   **設計時考慮：** 可維護性不是維護階段才考慮的問題，而是在軟體設計和開發之初就應融入的理念。
*   **影響因素：** 程式碼的清晰度、模組化程度、文件完整性、架構設計、測試覆蓋率、使用標準技術等都會影響可維護性。

**提升可維護性的策略：**
1.  **清晰的程式碼：** 良好的命名規範、適當的註解、簡潔的函式。
2.  **模組化設計：** 軟體應劃分為獨立、低耦合的模組，便於單獨修改和測試。
3.  **完善的文件：** 包括需求文件、設計文件、API文件和用戶手冊。
4.  **自動化測試：** 確保修改不會引入新的錯誤 (迴歸測試)。
5.  **版本控制：** 有效追蹤所有變更。
6.  **遵守編碼標準：** 提高程式碼的一致性和可讀性。
7.  **定期重構：** 積極改善內部結構，而不改變外部行為。

-----

#### 5. 常見錯誤與澄清

1.  **錯誤觀念：軟體維護就是修 Bug。**
    *   **澄清：** 這是最常見的誤解。如前所述，更正性維護（修 Bug）只是軟體維護的四種類型之一。適應性、完善性和預防性維護同樣重要，它們關注於軟體的演進、優化和長期健康。

2.  **錯誤觀念：維護階段不重要，投入少人力資源就好。**
    *   **澄清：** 維護階段的成本往往超過開發階段，且直接影響用戶滿意度和軟體的生命週期。投入足夠且經驗豐富的維護團隊至關重要，他們不僅要修復問題，還要推動軟體的持續改進。輕視維護會導致技術債務堆積、系統穩定性下降、用戶流失。

3.  **錯誤觀念：開發完成後，程式碼和文件就可以束之高閣。**
    *   **澄清：** 程式碼和文件需要隨著每次維護活動同步更新。過時或不完整的文件是維護團隊最大的障礙之一，大大增加理解系統和進行修改的成本。程式碼註解、設計文件、用戶手冊等都應被視為「活的文件」。

4.  **錯誤觀念：老舊系統既然能跑，就不需要特別維護。**
    *   **澄清：** 老舊系統（Legacy System）往往缺乏現代化技術支持、安全性漏洞較多、難以與新系統集成，且維護人員流失會導致知識斷層。雖然改造老舊系統成本高昂，但忽視它可能導致更高的安全風險、運營中斷和錯失發展機遇。定期的安全性更新、性能評估和適度的重構是必要的。

-----

#### 6. 小練習（附詳解）

##### 小練習一：維護類型判斷

請判斷以下情境分別屬於哪一種軟體維護類型，並簡述理由。

1.  某銀行系統發現一個罕見的死鎖問題，導致部分轉帳交易無法完成，需要緊急修復。
2.  一款手機 App 原本支援 Android 10，但隨著 Android 13 的推出，App 在新系統上出現了部分 UI 顯示異常，需要進行調整。
3.  為了提升用戶體驗，社交媒體 App 決定引入 AI 推薦演算法，根據用戶偏好展示更相關的內容。
4.  開發團隊意識到，現有支付模組的第三方支付閘道 API 已被標記為廢棄 (deprecated)，預計一年後將完全停止服務。團隊決定在問題發生前，提前將閘道切換到新的 API 版本。
5.  一家零售商的庫存管理系統，在每年黑色星期五購物節時，由於交易量暴增，資料庫查詢速度會急劇下降。開發團隊決定在下次購物節前，優化關鍵查詢語句並增加資料庫索引。

-----

##### 小練習一：詳解

1.  **更正性維護**。理由：系統出現了導致業務功能（轉帳交易）無法正常執行的錯誤（死鎖），需要修復以恢復正常功能。
2.  **適應性維護**。理由：軟體需要調整以適應外部環境（Android 作業系統）的變化，確保在新環境下能正常運行和顯示。
3.  **完善性維護**。理由：引入新功能（AI 推薦演算法）是為了改進軟體，提升用戶體驗和價值，而非修復錯誤或適應環境。
4.  **預防性維護**。理由：在第三方服務完全停止服務之前（潛在問題發生之前），主動進行修改（切換 API），以避免未來出現兼容性或服務中斷問題。
5.  **完善性維護** (也可以部分視為預防性)。理由：優化查詢語句和增加索引是為了提升軟體性能，以應對未來預期的流量高峰，改善用戶體驗。儘管是針對潛在的性能問題，但其主要目的是提升效率和使用者滿意度，因此更偏向完善性。如果更強調"避免崩潰"則有預防性成分。

-----

##### 小練習二：維護策略分析

一家新創公司開發了一款線上學習平台。平台剛上線一個月，用戶活躍度很高，但也收到了一些錯誤報告，同時產品經理也開始規劃下一階段的新功能。作為軟體工程師，你認為目前團隊應該如何分配軟體維護的精力（更正性、適應性、完善性、預防性），並請說明理由。

-----

##### 小練習二：詳解

對於一個剛上線一個月、用戶活躍度高且有錯誤報告的新創線上學習平台，維護策略應該是動態且優先級明確的。

**建議的維護精力分配與理由：**

1.  **更正性維護 (高優先級，初期投入最大精力)**
    *   **理由：** 剛上線的產品，用戶活躍度高意味著錯誤會被迅速發現和放大。緊急修復這些錯誤是穩定產品、建立用戶信任和避免用戶流失的關鍵。任何阻礙核心功能的 Bug 都應被列為最高優先級。此階段的 Bug 修正，往往能快速提升用戶滿意度。
    *   **實例：** 學習進度無法保存、影片無法播放、測驗結果錯誤等。

2.  **完善性維護 (次高優先級，持續投入)**
    *   **理由：** 雖然有 Bug，但新功能和優化是吸引和留住用戶的長期動力。新創公司需要快速迭代以保持競爭力，因此在修復關鍵 Bug 的同時，也需要將精力投入到用戶急需或能顯著提升體驗的功能上。然而，如果基礎不穩，倉促上新功能可能會導致更多 Bug。
    *   **實例：** 根據用戶回饋優化學習路徑、增加互動式測驗類型、改進課程搜尋功能。

3.  **預防性維護 (中等優先級，逐步增加投入)**
    *   **理由：** 雖然產品剛上線，但積累技術債務的速度很快。初期可能為了快速上線而犧牲了一些程式碼質量。在更正性維護穩定後，應逐步開始投入預防性維護，例如對高風險或核心模組進行程式碼審查、重構，或者更新潛在過時的函式庫，以避免未來出現更嚴重的問題。這有助於降低長期維護成本。
    *   **實例：** 重構不清晰的程式碼邏輯、加強日誌和監控系統、完善自動化測試。

4.  **適應性維護 (低至中等優先級，視外部環境變化)**
    *   **理由：** 產品剛上線，短期內運行環境可能相對穩定。除非有立即的外部環境（如作業系統大更新、第三方 API 變動）導致兼容性問題，否則其優先級可略低於前三者。但仍需保持對外部環境變化的關注。
    *   **實例：** 預防性地監控主流瀏覽器或行動作業系統的更新動態，但暫不需立即投入大量資源去適應尚未發生的變化。

**總結：**
初期應以「**穩**」（更正性維護）為第一要務，確保產品核心功能正常運行。隨後在穩定的基礎上，快速進行「**進**」（完善性維護），滿足用戶新需求，保持產品活力。同時，逐步融入「**防**」（預防性維護）的思維，為產品的長期健康發展打下基礎，並適度關注「**變**」（適應性維護）的需求。

-----

#### 7. 延伸閱讀/參考

*   **經典書籍：**
    *   **《人月神話》(The Mythical Man-Month)** by Frederick Brooks Jr.：雖然是較早期的著作，但其中關於軟體專案管理和維護成本的洞察至今仍具指導意義。
    *   **《軟體工程：實踐者的研究方法》(Software Engineering: A Practitioner's Approach)** by Roger S. Pressman / Bruce R. Maxim：軟體工程領域的經典教材，詳細介紹了軟體生命週期、維護類型和相關技術。
    *   **《重構：改善既有程式碼的設計》(Refactoring: Improving the Design of Existing Code)** by Martin Fowler：詳細講解了如何通過重構來提升程式碼質量和可維護性，這是完善性維護和預防性維護的重要實踐。

*   **標準與組織：**
    *   **IEEE (電機電子工程師學會)：** 提供了許多軟體工程相關的標準，例如 IEEE 1219 (Software Maintenance) 和 IEEE 14764 (Software Lifecycle Processes - Maintenance) 等。這些標準定義了軟體維護的流程、活動和角色。
    *   **ISO/IEC 14764：** 國際標準化組織和國際電工委員會共同發布的軟體生命週期流程—維護標準，詳細規範了軟體維護的各個方面。

*   **線上資源：**
    *   許多大學的軟體工程課程網站，通常會提供軟體維護相關的講義和案例研究。
    *   技術部落格和社群論壇，如 Stack Overflow、Medium 上的軟體開發專欄，常有關於如何處理技術債務、提升可維護性等實務分享。