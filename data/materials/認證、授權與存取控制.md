# 2-1 認證、授權與存取控制

本章節將深入探討資訊安全領域的三個核心概念：認證（Authentication）、授權（Authorization）與存取控制（Access Control）。這三者緊密相連，共同構建了系統安全防護的第一道防線，確保只有合法且具備適當權限的實體才能存取資源。

-----

## 1) 核心概念與定義

### #### 1.1 認證 (Authentication)

*   **定義/核心觀念：**
    認證是驗證某個主體（如使用者、程式或服務）所聲稱的身分是否真實的過程。它回答的問題是：「你真的是你所聲稱的那個人嗎？」

*   **例子或推導：**
    想像你正在登入你的網路銀行帳戶。
    1.  **身分識別 (Identification)：** 你輸入你的使用者名稱（例如 `bankuser123`），這是在聲明「我是 `bankuser123`」。
    2.  **認證 (Authentication)：** 系統要求你輸入密碼。當你輸入正確的密碼後，系統就會驗證你的身分，確認你確實是 `bankuser123`。

    認證主要透過以下三種要素或其組合來實現（多重要素認證）：
    *   **你知道什麼 (Something you know)：** 密碼、PIN碼、安全問題答案。
    *   **你擁有什麼 (Something you have)：** OTP（一次性密碼）產生器、實體安全金鑰、智慧卡、手機（接收簡訊驗證碼）。
    *   **你本身是什麼 (Something you are)：** 生物特徵，如指紋、臉部辨識、虹膜掃描。

*   **與相鄰概念的關聯：**
    認證是整個安全流程的第一步，是授權的前提。一個未經認證的主體無法被授權存取任何資源。

-----

### #### 1.2 授權 (Authorization)

*   **定義/核心觀念：**
    授權是決定一個已被認證的主體被允許對特定資源執行哪些操作的過程。它回答的問題是：「這個主體被允許做什麼？」

*   **例子或推導：**
    承接網路銀行的例子：
    一旦你成功認證為 `bankuser123`，系統會檢查你的帳戶類型和權限。
    *   如果你是普通客戶，你可能被授權：查看帳戶餘額、進行轉帳、修改個人資料。
    *   你可能**未被授權**：核准貸款、查看其他客戶的詳細資料。
    *   如果系統管理員登入，他可能被授權：管理所有客戶帳戶、配置系統設定。

    授權通常基於預先定義的政策、規則、角色或權限列表來執行。

*   **與相鄰概念的關聯：**
    授權緊隨認證之後。只有當主體的身分被確認後，系統才能根據其身分來判斷其權限。它是存取控制的核心決策部分。

-----

### #### 1.3 存取控制 (Access Control)

*   **定義/核心觀念：**
    存取控制是一個整體機制，它結合了身分識別、認證和授權，用於規定和執行對系統資源（如檔案、資料庫、應用程式功能）的存取許可。它確保只有被授權的主體才能執行被允許的操作。

*   **例子或推導：**
    綜合前述網路銀行範例：
    當你嘗試進行一筆轉帳操作時：
    1.  **身分識別：** 你輸入使用者名稱。
    2.  **認證：** 你輸入密碼，系統驗證你的身分。
    3.  **授權：** 系統檢查你的帳戶權限，確認你是否被允許進行轉帳（例如，是否有足夠餘額，是否超過單日轉帳限額）。
    4.  **存取控制執行：** 如果認證成功且授權允許，系統會執行轉帳操作；否則，操作被拒絕。

    存取控制是一個持續性的過程，它貫穿於主體與資源互動的整個生命週期。

*   **與相鄰概念的關聯：**
    存取控制是認證和授權的**總和與實施**。它是一個更廣泛的術語，包含了從身分識別、認證、授權決策到最終存取執行的所有環節。認證和授權是存取控制的兩個關鍵組成部分。

-----

## 2) 典型例子與情境應用

考慮一個公司內部文件管理系統。

1.  **使用者登入 (認證階段)：**
    *   員工 `Alice` 訪問文件系統的登入頁面，輸入她的使用者名稱 `alice@company.com` 和密碼。
    *   系統將 `Alice` 提供的憑證與儲存在使用者資料庫中的記錄進行比對。
    *   如果憑證匹配，`Alice` 的身分被成功認證。

2.  **文件存取與操作 (授權階段)：**
    *   `Alice` 認證成功後，瀏覽文件列表。她點擊了一個名為 `ProjectX_Spec.docx` 的文件。
    *   文件系統會檢查 `Alice` 對 `ProjectX_Spec.docx` 文件的權限。
    *   **情境 1：** `Alice` 是 `ProjectX` 團隊成員，被授權讀取和修改該文件。系統允許她打開文件並進行編輯。
    *   **情境 2：** `Alice` 是市場部的員工，但不是 `ProjectX` 團隊成員。系統的授權策略規定，市場部員工只能讀取 `ProjectX` 的「概要」文件，而不能讀取或修改「規格」文件。因此，系統拒絕 `Alice` 存取 `ProjectX_Spec.docx`。
    *   **情境 3：** `Alice` 嘗試刪除 `ProjectX_Spec.docx`。即使她有讀寫權限，但公司的政策可能規定只有專案經理才有刪除關鍵文件的權限。因此，系統拒絕她的刪除請求。

3.  **整個過程的存取控制：**
    從 `Alice` 輸入帳號密碼，到系統判斷她是否能讀取、編輯或刪除 `ProjectX_Spec.docx`，這整個流程都是存取控制的體現。存取控制系統負責：
    *   接收 `Alice` 的身分主張。
    *   驗證她的身分（認證）。
    *   根據她的身分和角色（或個別權限），判斷她對 `ProjectX_Spec.docx` 有哪些權限（授權）。
    *   根據授權結果，允許或拒絕她的操作。

-----

## 3) 與相鄰概念的關聯

### #### 3.1 關係圖

```mermaid
graph TD
    A[使用者身分主張 (Identification)] --> B{認證 (Authentication)};
    B -- 成功 --> C{授權 (Authorization)};
    C -- 允許 --> D[存取資源/執行操作];
    C -- 拒絕 --> E[拒絕存取];
    B -- 失敗 --> E;

    subgraph Access Control (存取控制)
        B; C; D; E;
    end
```

### #### 3.2 流程與職責

*   **身分識別 (Identification)：** 主體聲明自己是誰。這是認證的輸入。
*   **認證 (Authentication)：** 驗證主體所聲明身分的真實性。這是「閘門」，決定誰能進入系統。
*   **授權 (Authorization)：** 根據已認證的主體身分，判斷其被允許執行哪些操作或存取哪些資源。這是「權限清單」，決定主體在系統中能做什麼。
*   **存取控制 (Access Control)：** 是一個廣義的概念，包含了身分識別、認證和授權的**決策與執行機制**。它是一個策略性的框架，用於管理和限制對資源的存取。換句話說，認證和授權是存取控制的兩個核心環節。

### #### 3.3 其他相關安全原則

*   **最小權限原則 (Principle of Least Privilege)：**
    直接與授權相關。此原則建議主體只應被授予完成其任務所需的最低限度權限。過度授權是安全漏洞的常見來源。
*   **職責分離 (Separation of Duties)：**
    也與授權相關。將關鍵任務分解為多個部分，並分配給不同的主體，以防止單一主體濫用權力或造成重大錯誤。例如，一個會計不能同時核准和支付款項。
*   **不可否認性 (Non-repudiation)：**
    通常在強認證（如數位簽章）的基礎上實現。它確保主體不能否認他們已經執行過的操作。

-----

## 4) 進階內容：存取控制模型

存取控制模型是定義和實施存取控制政策的框架。常見的模型包括：

### #### 4.1 自主式存取控制 (Discretionary Access Control, DAC)

*   **核心觀念：** 資源的擁有者可以自行決定誰可以存取其資源以及擁有何種權限。
*   **特點：** 靈活性高，但安全性較低，因為權限可以任意傳遞，容易導致資訊洩漏或權限擴散。
*   **例子：**
    *   **檔案系統權限：** 在 Windows 或 Linux 系統中，檔案或目錄的建立者通常是其擁有者，可以設定其他使用者或群組的讀取、寫入、執行權限。例如，`chmod` 命令在 Linux 中就是用來設定 DAC 權限。
    *   **雲端儲存：** Dropbox 或 Google Drive 使用者可以分享他們的檔案給其他人，並設定對方的檢視、編輯權限。

### #### 4.2 強制式存取控制 (Mandatory Access Control, MAC)

*   **核心觀念：** 系統層級的政策決定所有主體和資源的存取權限，資源的擁有者無法自行修改。主體和資源都被分配了安全標籤（例如：機密等級、類別），系統根據這些標籤匹配來決定存取權。
*   **特點：** 安全性最高，適用於需要高度安全隔離的環境（如軍事、政府）。靈活性差，管理複雜。
*   **例子：**
    *   **軍事/政府系統：** 文件可能被標記為「機密」、「絕密」，而使用者被標記為具有「Top Secret」或「Secret」的許可。系統只允許具有相等或更高安全許可的使用者存取相應標籤的資源。
    *   **SELinux (Security-Enhanced Linux)：** 這是一個為 Linux 核心提供的安全模組，實施了 MAC 策略，用於限制程序、檔案和網路資源的互動，即使是 root 使用者也可能受到限制。

### #### 4.3 角色基礎存取控制 (Role-Based Access Control, RBAC)

*   **核心觀念：** 權限不是直接賦予給使用者，而是賦予給角色。使用者被分配一個或多個角色，從而繼承這些角色的權限。
*   **特點：** 大多數企業和組織採用的模型。管理簡便，擴展性好，符合最小權限原則。
*   **例子：**
    *   **企業應用系統：**
        *   `財務部主管` 角色：被授權核准大額支出。
        *   `財務部員工` 角色：被授權輸入帳目、查看報告。
        *   `人事部主管` 角色：被授權修改員工薪資、批准休假。
        *   `IT 管理員` 角色：被授權管理伺服器、配置網路。
    *   一個員工 `David` 擔任「財務部主管」和「人事部員工」兩個角色，他將同時擁有這兩個角色的所有權限。當 `David` 離職時，只需從角色中移除 `David`，無需逐一撤銷其權限。

### #### 4.4 屬性基礎存取控制 (Attribute-Based Access Control, ABAC)

*   **核心觀念：** 存取決策基於主體（使用者）、資源、環境的各種屬性，以及操作本身。它是一個非常靈活和細粒度的模型。
*   **特點：** 極高的靈活性和細粒度控制，適合複雜和動態的環境。管理和實施相對複雜。
*   **例子：**
    *   **雲端服務：** 一條政策可能聲明：「如果主體是位於 `台灣` 的 `經理` 且工作時間在 `早上9點到下午5點` 之間，則允許他 `讀取` 任何被標記為 `客戶資料` 且 `敏感等級為高` 的 `檔案`。」
        *   主體屬性：地點（台灣）、職位（經理）、時間（工作時間）。
        *   資源屬性：類型（客戶資料）、敏感等級（高）。
        *   操作屬性：讀取。
    *   **IoT (物聯網) 裝置管理：** 根據裝置的類型、位置、健康狀態以及操作者的部門來動態決定其能否被存取和控制。

-----

## 5) 常見錯誤與澄清

*   **錯誤：** 認為只要有強大的認證機制，系統就足夠安全了。
    *   **澄清：** 認證只能確認「你是誰」，但不能限制「你能做什麼」。一個攻擊者即使透過高超手段繞過認證，也可能因未經授權而無法對核心資源進行破壞。反之，一個被成功認證但被過度授權的內部使用者，也可能對系統造成損害。授權是不可或缺的環節。
*   **錯誤：** 將認證和授權混為一談，認為它們是同一回事。
    *   **澄清：** 認證是「**身分驗證**」，授權是「**權限賦予**」。它們是不同的階段和功能。先驗證身分，再決定權限。
*   **錯誤：** 在設計系統時，只考慮到「允許」什麼，而忽略了「不允許」什麼。
    *   **澄清：** 應採用「預設拒絕 (Deny by Default)」原則，即沒有明確允許的，一律拒絕。這比只列出允許的項目更安全，可以避免未預料到的權限漏洞。
*   **錯誤：** 忽略最小權限原則，給予使用者過多的權限以圖方便。
    *   **澄清：** 過度授權是導致資料洩漏和內部威脅的常見原因。即使是系統管理員，也應只在需要時才使用其最高權限，或使用職責分離的原則。

-----

## 6) 小練習（附詳解）

### #### 小練習 1：情境分析

你的公司開發了一款名為「ProjectFlow」的專案管理軟體。軟體中有以下幾個角色和功能：

*   **功能：**
    *   建立專案
    *   編輯專案細節
    *   刪除專案
    *   檢視專案報告
    *   分配任務給專案成員
*   **使用者：**
    *   `Manager John` (專案經理)
    *   `Developer Alice` (開發人員)
    *   `Guest Bob` (外部合作夥伴)

請你根據這些資訊，說明「ProjectFlow」系統如何運用**認證**、**授權**和**存取控制**來管理這三個使用者的行為。

#### 解答 1：

1.  **認證階段：**
    *   **步驟 1：身分識別與認證請求。**
        `Manager John`、`Developer Alice` 和 `Guest Bob` 分別在登入頁面輸入他們各自的使用者名稱和密碼。這是一個聲明其身分的過程。
    *   **步驟 2：身分驗證。**
        「ProjectFlow」系統會接收這些憑證，並將其與系統中儲存的使用者資料進行比對。例如，它可能會檢查密碼雜湊值是否匹配，或者透過雙因素認證（2FA）進一步確認身分。
    *   **步驟 3：認證結果。**
        如果憑證正確，系統會成功認證使用者，允許他們進入應用程式。如果憑證不正確，認證失敗，使用者會被拒絕存取。

2.  **授權階段 (一旦認證成功)：**
    系統根據成功認證的使用者身分，判斷他們被允許執行哪些操作。

    *   **Manager John (專案經理)：**
        `Manager John` 的角色通常被賦予較高的權限。系統可能授權他：
        *   建立專案：`允許`
        *   編輯專案細節：`允許` (所有專案)
        *   刪除專案：`允許` (所有專案)
        *   檢視專案報告：`允許` (所有報告)
        *   分配任務給專案成員：`允許` (所有專案成員)

    *   **Developer Alice (開發人員)：**
        `Developer Alice` 的角色權限通常會受限於她所參與的專案。系統可能授權她：
        *   建立專案：`拒絕`
        *   編輯專案細節：`允許` (僅限於她被指派的專案)
        *   刪除專案：`拒絕`
        *   檢視專案報告：`允許` (僅限於她被指派的專案報告)
        *   分配任務給專案成員：`允許` (僅限於她被指派專案的成員，且通常僅限於她建立的任務)

    *   **Guest Bob (外部合作夥伴)：**
        `Guest Bob` 的權限通常是最小的，且可能只限於檢視。系統可能授權他：
        *   建立專案：`拒絕`
        *   編輯專案細節：`拒絕`
        *   刪除專案：`拒絕`
        *   檢視專案報告：`允許` (僅限於被明確分享給他的特定報告)
        *   分配任務給專案成員：`拒絕`

3.  **存取控制的整體實施：**
    *   **政策定義：** 公司安全團隊或專案管理員會預先定義各個角色（專案經理、開發人員、外部合作夥伴）的權限集。這通常是基於 RBAC (角色基礎存取控制) 模型。
    *   **執行與監控：** 當 `Manager John` 嘗試刪除一個專案時，「ProjectFlow」的存取控制模組會檢查他的認證狀態，然後查詢他的授權權限。如果授權允許，則執行刪除；否則，操作被阻止並可能記錄為安全事件。
    *   **動態決策：** 當 `Developer Alice` 嘗試編輯一個專案細節時，系統不僅會看她是否被授權「編輯專案」，還會檢查她是否有權限編輯「這個特定的專案」。這涉及更細粒度的存取控制邏輯。

這個例子展示了認證作為第一道關卡，而授權則根據身分和定義的政策，精確控制不同使用者在系統中的行動範圍，最終由存取控制系統統一執行這些安全規則。

---

### #### 小練習 2：模型匹配

請將以下情境與最適合的存取控制模型 (DAC, MAC, RBAC, ABAC) 進行匹配，並簡要說明原因。

1.  **情境 A：** 公司的 HR 系統，主管可以核准員工的請假，但員工只能提交請假申請。系統中有「主管」、「員工」和「HR管理員」等角色。
2.  **情境 B：** 某研究實驗室的資料庫，每個研究資料都被標記為「公開」、「受限」或「機密」。研究人員根據其安全許可級別（例如「受限研究員」、「機密研究員」）來存取相應的資料。資料的創造者無法自行改變安全標籤。
3.  **情境 C：** 個人部落格網站，每個部落格文章的作者可以選擇讓「所有人閱讀」、「只有朋友閱讀」或「只有自己閱讀」。
4.  **情境 D：** 一個智慧建築管理系統，策略是：「如果操作者是 `IT 部門` 的 `資深工程師`，並且現在是 `工作時間` (上午 8 點至下午 6 點)，則允許他 `遠端重啟` 位於 `三樓` 的 `空調系統`。」

#### 解答 2：

1.  **情境 A：公司 HR 系統**
    *   **匹配模型：** 角色基礎存取控制 (RBAC)
    *   **原因：** 權限是基於使用者的「角色」（主管、員工、HR管理員）來定義的，而不是直接賦予給單個使用者。這符合 RBAC 的核心特徵，易於管理企業級的權限。

2.  **情境 B：研究實驗室資料庫**
    *   **匹配模型：** 強制式存取控制 (MAC)
    *   **原因：** 系統根據預定義的「安全標籤」（如「公開」、「受限」、「機密」）和使用者的「安全許可級別」來決定存取權，且資料的擁有者無法自行改變這些標籤。這體現了 MAC 的集中式、嚴格的安全政策。

3.  **情境 C：個人部落格網站**
    *   **匹配模型：** 自主式存取控制 (DAC)
    *   **原因：** 文章作者（即資源擁有者）可以自行決定誰（所有人、朋友、自己）可以存取（閱讀）其文章。這是 DAC 的典型特徵，賦予資源擁有者高度的存取控制權。

4.  **情境 D：智慧建築管理系統**
    *   **匹配模型：** 屬性基礎存取控制 (ABAC)
    *   **原因：** 存取決策基於多個動態屬性，包括主體屬性（部門、職稱）、環境屬性（時間）和資源屬性（位置、系統類型），而不是簡單的固定角色或擁有者。ABAC 提供了這種高度細粒度、基於條件的存取控制能力。

-----

## 7) 延伸閱讀/參考

*   **RFC 4949 - Internet Security Glossary, Version 2:** 提供關於網路安全術語的標準定義。
*   **NIST SP 800-162 - Guide to Attribute Based Access Control (ABAC) Definition and Consideration:** 美國國家標準與技術研究院關於 ABAC 的詳細指南。
*   **The Bell-LaPadula Model and Biba Model:** 兩種經典的 MAC 模型，分別關注機密性和完整性。
*   **OAuth 2.0 和 OpenID Connect：** 廣泛用於網際網路服務的認證與授權協議框架，通常用於實現單一登入 (SSO) 和委託授權。
*   **SAML (Security Assertion Markup Language)：** 用於在不同安全領域之間交換認證和授權數據的 XML 框架。
*   **資訊安全概論 (Introduction to Information Security) 相關書籍：** 任何關於資訊安全的教科書都會深入探討這些基本概念。