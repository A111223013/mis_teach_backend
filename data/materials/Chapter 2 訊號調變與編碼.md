# Chapter 2 訊號調變與編碼

本章將深入探討訊號調變（Modulation）與編碼（Coding）這兩項在現代通訊系統中不可或缺的核心技術。從類比到數位，這些技術使得資訊能夠有效地從發送端傳輸到接收端，克服物理通道的限制，並確保資料的完整性與可靠性。

-----

### 2.1 核心概念與定義

#### 2.1.1 訊號調變 (Signal Modulation)

**定義/核心觀念：**
訊號調變是指將承載資訊的基頻訊號（Modulating Signal，又稱調變訊號或基頻訊號）疊加到一個高頻載波（Carrier Wave）上的過程。載波的某個特性（如振幅、頻率或相位）會隨著基頻訊號的變化而改變。

**目的：**
*   **頻率轉換：** 將基頻訊號的頻譜上移到一個更高的頻段，以利於無線傳輸（低頻訊號傳輸效率差，所需天線尺寸過大）。
*   **多工傳輸：** 允許多個訊號同時共享同一個傳輸介質（如無線電波），透過分配不同的載波頻率實現頻分多工（FDM）。
*   **增強抗雜訊能力：** 特定調變技術（如FM）在某些情況下能提供更好的抗雜訊效能。
*   **天線尺寸：** 高頻載波使得天線尺寸更實際。

-----

#### 2.1.2 訊號編碼 (Signal Coding)

**定義/核心觀念：**
訊號編碼是指將原始資訊轉換成特定格式的過程，以達到數據壓縮、錯誤控制或安全傳輸等目的。根據其目的，編碼可分為源碼編碼和通道編碼。

**目的：**
*   **源碼編碼（Source Coding，又稱數據壓縮）：** 減少資訊的冗餘性，以降低儲存空間或傳輸頻寬需求。
*   **通道編碼（Channel Coding，又稱錯誤控制編碼）：** 增加資訊的冗餘性，以在傳輸過程中檢測並糾正錯誤，提高傳輸的可靠性。
*   **安全編碼（Security Coding）：** 透過加密等方式保護資訊不被未經授權者存取。

-----

#### 2.1.3 調變類型概述

**類比調變 (Analog Modulation)：**
當基頻訊號是類比訊號時，我們使用類比調變。
*   **振幅調變 (Amplitude Modulation, AM)：** 載波的振幅隨基頻訊號的變化而改變，頻率和相位保持不變。
*   **頻率調變 (Frequency Modulation, FM)：** 載波的頻率隨基頻訊號的變化而改變，振幅和相位保持不變。
*   **相位調變 (Phase Modulation, PM)：** 載波的相位隨基頻訊號的變化而改變，振幅和頻率保持不變。

**數位調變 (Digital Modulation)：**
當基頻訊號是數位訊號時（通常是經由數位化後的類比訊號或原始數位資料），我們使用數位調變。這通常也被稱為「鍵控（Keying）」。
*   **振幅移位鍵控 (Amplitude Shift Keying, ASK)：** 載波的振幅根據數位基頻訊號的不同值而改變。
*   **頻率移位鍵控 (Frequency Shift Keying, FSK)：** 載波的頻率根據數位基頻訊號的不同值而改變。
*   **相位移位鍵控 (Phase Shift Keying, PSK)：** 載波的相位根據數位基頻訊號的不同值而改變。常見的有二進位相位移位鍵控（BPSK）、正交相位移位鍵控（QPSK）等。
*   **正交振幅調變 (Quadrature Amplitude Modulation, QAM)：** 結合了ASK和PSK，同時改變載波的振幅和相位。

-----

### 2.2 典型例子與數學推導

#### 2.2.1 類比調變：振幅調變 (AM)

**核心觀念：** 將基頻訊號的振幅變化映射到高頻載波的振幅上。

**數學推導：**
假設基頻訊號為 $m(t)$，載波訊號為 $c(t) = A_c \cos(2\pi f_c t)$。
最簡單的雙邊帶全載波振幅調變（DSB-WC AM）訊號 $s(t)$ 可以表示為：
$s(t) = A_c [1 + k_a m(t)] \cos(2\pi f_c t)$

其中：
*   $A_c$ 是載波振幅。
*   $f_c$ 是載波頻率。
*   $k_a$ 是振幅敏感度，決定了基頻訊號對載波振幅的影響程度。
*   $[1 + k_a m(t)]$ 稱為包絡線（Envelope），它包含了原始基頻訊號的資訊。
*   為了避免包絡線失真，通常要求 $|k_a m(t)| \le 1$。
*   **調變指數 (Modulation Index) $m_a = k_a A_m$**，其中 $A_m$ 是 $m(t)$ 的峰值振幅。當 $m_a \le 1$ 時，訊號沒有過度調變。

**頻譜：**
如果 $m(t)$ 的最高頻率為 $W$ (即頻寬為 $W$)，則 $s(t)$ 的頻譜將包含：
1.  位於 $f_c$ 的載波分量。
2.  位於 $(f_c - W)$ 到 $f_c$ 的下邊帶（Lower Sideband, LSB）。
3.  位於 $f_c$ 到 $(f_c + W)$ 的上邊帶（Upper Sideband, USB）。
因此，AM 訊號的頻寬為 $2W$。

-----

#### 2.2.2 類比調變：頻率調變 (FM)

**核心觀念：** 將基頻訊號的振幅變化映射到高頻載波的瞬時頻率上。

**數學推導：**
FM 訊號的瞬時頻率 $f_i(t)$ 隨基頻訊號 $m(t)$ 變化：
$f_i(t) = f_c + k_f m(t)$

其中：
*   $f_c$ 是載波中心頻率。
*   $k_f$ 是頻率敏感度，單位為 Hz/V。
*   載波的相位是瞬時頻率的積分：$\phi_i(t) = 2\pi \int f_i(\tau) d\tau = 2\pi f_c t + 2\pi k_f \int m(\tau) d\tau$。
FM 訊號 $s(t)$ 可以表示為：
$s(t) = A_c \cos(2\pi f_c t + 2\pi k_f \int_{-\infty}^{t} m(\tau) d\tau)$

**調變指數 (Modulation Index) $\beta = \frac{\Delta f}{W}$**，其中 $\Delta f = k_f A_m$ 是最大頻率偏移， $W$ 是基頻訊號的最高頻率。

**頻寬：**
FM 訊號的頻譜比 AM 更複雜，通常是無限頻寬的。但根據**卡森法則 (Carson's Rule)**，有效頻寬可以近似為：
$B_{FM} \approx 2(\Delta f + W) = 2(k_f A_m + W)$
或 $B_{FM} \approx 2W(1+\beta)$。

-----

#### 2.2.3 數位調變：QPSK (Quadrature Phase Shift Keying)

**核心觀念：** QPSK 是一種相位調變，每次傳輸兩個位元（dibit），並將這兩個位元映射到載波的四個不同相位中的一個。

**例子：**
假設我們有載波 $c(t) = A \cos(2\pi f_c t)$ 和 $s(t) = A \sin(2\pi f_c t)$ (正交載波)。
一個 QPSK 符號（Symbol）代表兩個位元。例如：
*   `00` $\rightarrow$ 相位 $45^\circ$
*   `01` $\rightarrow$ 相位 $135^\circ$
*   `11` $\rightarrow$ 相位 $225^\circ$
*   `10` $\rightarrow$ 相位 $315^\circ$

數學表示：
一個 QPSK 符號可以表示為 $s_i(t) = A \cos(2\pi f_c t + \phi_i)$，其中 $\phi_i \in \{ \frac{\pi}{4}, \frac{3\pi}{4}, \frac{5\pi}{4}, \frac{7\pi}{4} \}$。
這等效於將訊號分解為兩個正交分量（I 和 Q）：
$s(t) = I(t) \cos(2\pi f_c t) - Q(t) \sin(2\pi f_c t)$
其中 $I(t)$ 和 $Q(t)$ 分別根據輸入的兩個位元而取不同的離散值（例如 $\pm \frac{A}{\sqrt{2}}$）。

**星座圖 (Constellation Diagram)：**
QPSK 訊號可以在複平面上用四個點表示，每個點代表一個相位和振幅的組合。對於理想 QPSK，這四個點位於以原點為中心的圓上。

```
     Im (Q-axis)
      ^
      |
   01 x   x 00
      |
<-----+-----+------> Re (I-axis)
      |
   11 x   x 10
      |
```

-----

#### 2.2.4 通道編碼：漢明碼 (Hamming Code)

**核心觀念：** 漢明碼是一種線性分組碼，它能在訊息中加入冗餘位元，使得單一位元錯誤可以被檢測和糾正。

**例子：(7,4) 漢明碼**
這表示每 $k=4$ 個資料位元會產生一個 $n=7$ 位元的碼字，其中 $r=3$ 個位元是校驗位元。
假設資料位元 $d_3 d_2 d_1 d_0$。
校驗位元 $p_2 p_1 p_0$ 根據以下規則計算：
$p_0 = d_0 \oplus d_1 \oplus d_3$
$p_1 = d_0 \oplus d_2 \oplus d_3$
$p_2 = d_1 \oplus d_2 \oplus d_3$

碼字 $c_6 c_5 c_4 c_3 c_2 c_1 c_0$ 通常按以下順序組合：$c_6 c_5 c_4 p_2 p_1 p_0 c_0$ 或其他約定，這裡我們使用常見的格式：
$c_0=d_0, c_1=d_1, c_2=d_2, c_3=p_0, c_4=d_3, c_5=p_1, c_6=p_2$ (注意位元順序可能因教材而異)
更常見的表示方式是將校驗位元放在 $2^x$ 的位置：
$m_1 m_2 m_3 m_4 m_5 m_6 m_7$
$p_0$ 在 $m_1$
$p_1$ 在 $m_2$
$d_0$ 在 $m_3$
$p_2$ 在 $m_4$
$d_1$ 在 $m_5$
$d_2$ 在 $m_6$
$d_3$ 在 $m_7$

其中：
$p_0 = m_3 \oplus m_5 \oplus m_7$ (檢查位元1,3,5,7)
$p_1 = m_3 \oplus m_6 \oplus m_7$ (檢查位元2,3,6,7)
$p_2 = m_5 \oplus m_6 \oplus m_7$ (檢查位元4,5,6,7)

如果接收到的碼字有誤，可以計算一個稱為「校驗子 (Syndrome)」的值來定位錯誤。

-----

### 2.3 與相鄰概念的關聯

#### 2.3.1 調變與傅立葉轉換 (Fourier Transform)

**關聯：**
傅立葉轉換是分析訊號頻譜的強大工具。調變的本質就是將基頻訊號的頻譜搬移到載波頻率附近。傅立葉轉換可以清晰地展示調變前後訊號頻譜的變化，例如 AM 訊號的邊帶結構、FM 訊號的頻率擴展等。沒有傅立葉分析，我們將難以理解調變訊號所需的頻寬。

#### 2.3.2 編碼與資訊理論 (Information Theory)

**關聯：**
資訊理論由克勞德·香農（Claude Shannon）創立，提供了一套量化資訊、通道容量和錯誤率的數學框架。
*   **源碼編碼**直接與資訊熵（Entropy）相關，目標是去除冗餘以接近資訊的本質下限。
*   **通道編碼**則與香農的**有雜訊通道編碼定理 (Noisy Channel Coding Theorem)** 緊密相關。該定理指出，只要傳輸速率低於通道容量，就存在一種編碼方案，可以以任意小的錯誤率進行可靠通訊。通道編碼的目標就是設計出能夠逼近這個理論極限的實際編碼方案。

#### 2.3.3 調變與多工 (Multiplexing)

**關聯：**
多工技術允許不同使用者或不同類型的資訊共享同一物理傳輸通道。
*   **頻分多工 (Frequency Division Multiplexing, FDM)：** 透過將每個訊號調變到不同的載波頻率上，然後將這些不同頻率的調變訊號組合起來，實現 FDM。接收端再使用濾波器和解調變器分離各個訊號。
*   **分碼多工 (Code Division Multiplexing, CDM)：** 則涉及將每個使用者訊號與一個獨特的偽隨機碼序列進行擴頻（Spread Spectrum）調變，使得多個使用者可以在同一頻率、同一時間進行通訊。

-----

### 2.4 進階內容：調變效率與抗雜訊能力

#### 2.4.1 頻譜效率 (Spectral Efficiency)

**定義：** 頻譜效率衡量單位頻寬內可傳輸的資料速率，通常以 bps/Hz (bits per second per Hertz) 表示。
**關聯：** 高階數位調變（如 QAM）通常比低階調變（如 BPSK）具有更高的頻譜效率，因為它們在每個符號中能承載更多的位元。例如，QPSK 每符號傳輸 2 位元，16-QAM 每符號傳輸 4 位元，因此在相同符號率下，16-QAM 的位元率是 QPSK 的兩倍。

#### 2.4.2 功率效率 (Power Efficiency) 與抗雜訊能力

**定義：** 功率效率衡量在給定錯誤率下所需的發射功率。
**關聯：** 不同的調變方案在雜訊環境下的表現不同。例如，FM 通常比 AM 具有更好的抗雜訊能力（閾值效應）。在數位調變中，BPSK 在相同的誤碼率（BER）下通常需要較低的信噪比（SNR），表示其功率效率相對較高，但也犧牲了頻譜效率。高階調變雖然頻譜效率高，但對雜訊更敏感，需要更高的 SNR 才能達到相同的錯誤率。

-----

### 2.5 常見錯誤與澄清

#### 2.5.1 數位調變與基頻編碼的混淆

**常見錯誤：** 有些學生會將「數位調變」與「基頻編碼（Line Coding，又稱線路編碼）」混淆。
**澄清：**
*   **基頻編碼 (Line Coding)：** 是指將原始數位位元序列轉換成適合在**基頻**通道上傳輸的電氣脈衝訊號的過程，例如不歸零碼 (NRZ)、曼徹斯特碼 (Manchester Code) 等。它解決的是如何在數位傳輸中表示0和1，並處理直流分量、時脈恢復等問題。其輸出仍然是基頻訊號。
*   **數位調變 (Digital Modulation)：** 則是將這些經過基頻編碼或原始數位位元序列，疊加到一個高頻載波上，以實現**頻帶傳輸**。它將數位訊號轉換為類比射頻訊號，以便無線或高頻有線傳輸。

**範例：**
網路線上的乙太網路訊號（例如100BASE-TX）使用了曼徹斯特編碼或MLT-3編碼等基頻編碼，但沒有進行高頻載波調變。而 Wi-Fi 訊號則使用了 QPSK、16-QAM 等數位調變技術，將數位資料載在 2.4 GHz 或 5 GHz 的載波上。

#### 2.5.2 源碼編碼與通道編碼的目的混淆

**常見錯誤：** 認為所有編碼都是為了提高傳輸可靠性或都是為了壓縮數據。
**澄清：**
*   **源碼編碼**的目的是**壓縮數據**，減少傳輸的位元數量，以提高頻寬利用率或減少儲存空間。它透過去除數據中的冗餘來實現。
*   **通道編碼**的目的是**增加冗餘**，以便在傳輸過程中檢測和糾正錯誤，從而提高傳輸的可靠性。這些額外的冗餘位元雖然會增加傳輸量，但卻能對抗通道雜訊和干擾。

**兩者關係：** 在實際通訊系統中，源碼編碼通常在通道編碼之前進行，先壓縮資料，然後再為壓縮後的資料添加錯誤控制碼。

-----

### 2.6 小練習 (附詳解)

#### 2.6.1 小練習一：AM 訊號頻寬計算

**題目：**
一個基頻訊號 $m(t) = 5 \cos(2\pi \cdot 2000 t)$ 經過標準 AM 調變（DSB-WC），載波頻率為 $f_c = 100 \text{ kHz}$。
請計算：
1.  基頻訊號的最高頻率（頻寬）。
2.  此 AM 訊號的頻寬。
3.  如果該訊號的調變指數 $m_a = 0.8$，寫出其調變訊號的數學表達式（假設載波振幅 $A_c = 10 \text{ V}$）。

**詳解：**
1.  **基頻訊號的最高頻率（頻寬）：**
    基頻訊號 $m(t) = 5 \cos(2\pi \cdot 2000 t)$ 是一個單頻餘弦波，其頻率為 $f_m = 2000 \text{ Hz} = 2 \text{ kHz}$。
    因此，基頻訊號的最高頻率（或稱頻寬 $W$）為 $2 \text{ kHz}$。
2.  **AM 訊號的頻寬：**
    對於標準 AM（DSB-WC），頻寬為基頻訊號頻寬的兩倍。
    $B_{AM} = 2W = 2 \times 2 \text{ kHz} = 4 \text{ kHz}$。
    這表示該 AM 訊號將佔用從 $(f_c - W)$ 到 $(f_c + W)$ 的頻率範圍，即 $98 \text{ kHz}$ 到 $102 \text{ kHz}$。
3.  **調變訊號的數學表達式：**
    AM 訊號的通用表達式為 $s(t) = A_c [1 + k_a m(t)] \cos(2\pi f_c t)$。
    已知 $m_a = k_a A_m = 0.8$，基頻訊號峰值振幅 $A_m = 5 \text{ V}$。
    所以，$k_a = \frac{m_a}{A_m} = \frac{0.8}{5} = 0.16 \text{ V}^{-1}$。
    將已知值代入公式：
    $s(t) = 10 [1 + 0.16 \cdot (5 \cos(2\pi \cdot 2000 t))] \cos(2\pi \cdot 100000 t)$
    $s(t) = 10 [1 + 0.8 \cos(2\pi \cdot 2000 t)] \cos(2\pi \cdot 100000 t)$

-----

#### 2.6.2 小練習二：QPSK 星座圖與位元映射

**題目：**
一個 QPSK 調變系統採用格雷碼（Gray Code）映射，如下所示：
*   $00 \rightarrow 45^\circ$
*   $01 \rightarrow 135^\circ$
*   $11 \rightarrow 225^\circ$
*   $10 \rightarrow 315^\circ$
假設發射振幅恆定為 $A$，請：
1.  繪製其星座圖，並標註每個點對應的位元序列。
2.  如果接收到一個符號，其相位位於 $200^\circ$ 處，請判斷最可能發送的是哪個位元序列。

**詳解：**
1.  **星座圖：**
    QPSK 星座圖有四個點，代表四種相位。在複平面上，這四個點位於以原點為中心的圓上，間隔 $90^\circ$。
    
    ```
         Im (Q-axis)
          ^
          |
       01 x       x 00
          |
    <-----+-------+-----> Re (I-axis)
          |
       11 x       x 10
          |
    ```
    
    每個 'x' 代表一個符號點，並標註其對應的格雷碼位元序列。例如，$00$ 在第一象限（$45^\circ$），$01$ 在第二象限（$135^\circ$），$11$ 在第三象限（$225^\circ$），$10$ 在第四象限（$315^\circ$）。
    
2.  **判斷接收到的位元序列：**
    接收到的符號相位為 $200^\circ$。我們需要找出離 $200^\circ$ 最近的理想 QPSK 相位點。
    *   $45^\circ$ 與 $200^\circ$ 的距離為 $|200 - 45| = 155^\circ$。
    *   $135^\circ$ 與 $200^\circ$ 的距離為 $|200 - 135| = 65^\circ$。
    *   $225^\circ$ 與 $200^\circ$ 的距離為 $|200 - 225| = 25^\circ$。
    *   $315^\circ$ 與 $200^\circ$ 的距離為 $|200 - 315| = 115^\circ$ (或 $360 - 115 = 245^\circ$, 選擇較小的)。
    
    最短的距離是 $25^\circ$，對應的理想相位是 $225^\circ$。
    根據給定的格雷碼映射，$225^\circ$ 對應的位元序列是 `11`。
    因此，最可能發送的是位元序列 `11`。

-----

### 2.7 延伸閱讀與參考

1.  **"Digital Communications" by John G. Proakis:** 數位通訊領域的經典教材，深入講解了調變、編碼和訊號處理的理論。
2.  **"Communication Systems" by Simon Haykin:** 涵蓋了類比和數位通訊系統的廣泛內容，對於理解調變的基礎原理非常有幫助。
3.  **"Principles of Digital Communication" by Robert G. Gallager:** 另一本關於數位通訊理論的權威書籍，尤其在資訊理論和編碼方面有深刻的闡述。
4.  **IEEE Xplore Digital Library:** 專業的學術資料庫，可以查找最新的通訊技術論文和標準。
5.  **線上課程平台 (Coursera, edX, MIT OpenCourseWare):** 許多大學提供免費或付費的通訊原理和數位訊號處理課程，可以搭配教材進行學習。