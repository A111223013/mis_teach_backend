# 假設檢定：從概念到實踐

假設檢定是統計推斷的基石之一，它提供了一個系統化的框架，讓我們能夠根據樣本數據來評估關於總體（Population）的聲明或假設。在科學研究、商業決策乃至日常生活中，假設檢定無處不在，幫助我們從不確定性中尋找證據，做出更明智的判斷。

-----

### 1. 核心概念與定義

假設檢定的核心思想是，我們對總體參數（例如總體平均值、總體比例）有一個初步的假設，然後收集樣本數據，利用這些數據來判斷我們的初步假設是否合理。

#### 1.1 虛無假設 (Null Hypothesis, $H_0$)

*   **定義：** 虛無假設是我們在檢定開始時所做的「沒有效應」、「沒有差異」、「沒有關係」或「現狀」的聲明。它通常包含等號（$=$, $\ge$, $\le$）。
*   **核心觀念：** 我們總是假設虛無假設為真，直到有足夠的證據證明其為假。它代表了我們想要挑戰的「預設」狀態。
*   **例子：**
    *   某藥物對血壓沒有影響：$H_0: \mu_{新藥} = \mu_{舊藥}$
    *   新產品的平均壽命不超過1000小時：$H_0: \mu \le 1000$
    *   硬幣是公平的：$H_0: p = 0.5$ (正面的機率)

#### 1.2 對立假設 (Alternative Hypothesis, $H_1$ 或 $H_a$)

*   **定義：** 對立假設是我們希望證明為真的聲明，它與虛無假設相反。它通常不包含等號（$\ne$, $<$, $>$）。
*   **核心觀念：** 對立假設是研究者真正感興趣的、希望透過實驗數據來證實的觀點。
*   **例子：**
    *   某藥物對血壓有影響：$H_1: \mu_{新藥} \ne \mu_{舊藥}$
    *   新產品的平均壽命超過1000小時：$H_1: \mu > 1000$
    *   硬幣是不公平的：$H_1: p \ne 0.5$

#### 1.3 檢定統計量 (Test Statistic)

*   **定義：** 檢定統計量是從樣本數據計算出來的一個單一數值，它量化了樣本數據與虛無假設預期的差異程度。這個統計量的抽樣分佈在虛無假設為真時是已知的（例如 Z 分佈、t 分佈、卡方分佈、F 分佈）。
*   **核心觀念：** 我們用檢定統計量來衡量觀察到的數據與虛無假設之間的「距離」。距離越大，推翻虛無假設的證據就越強。
*   **例子：**
    *   Z 統計量：$Z = \frac{\bar{X} - \mu_0}{\sigma/\sqrt{n}}$ (當總體標準差已知或樣本量夠大時)
    *   t 統計量：$t = \frac{\bar{X} - \mu_0}{s/\sqrt{n}}$ (當總體標準差未知且樣本量較小時)

#### 1.4 顯著水準 (Significance Level, $\alpha$)

*   **定義：** 顯著水準是我們在做出決策時，願意承擔「型一錯誤」的最大機率。它是在進行假設檢定前預先設定的一個小數值，通常為 0.05 或 0.01。
*   **核心觀念：** $\alpha$ 設定了我們拒絕虛無假設的「門檻」。如果觀察到的數據的極端程度超過了這個門檻，我們就拒絕 $H_0$。
*   **與相鄰概念的關聯：** $\alpha$ 直接決定了拒絕域（Rejection Region）的大小。

#### 1.5 P 值 (P-value)

*   **定義：** P 值是指在虛無假設為真的前提下，觀察到的檢定統計量或比它更極端的數據發生的機率。
*   **核心觀念：** P 值衡量了觀察到當前數據（或更極端數據）的「驚訝程度」。P 值越小，說明當虛無假設為真時，我們觀察到的數據越不可能發生，因此拒絕虛無假設的證據越強。
*   **與相鄰概念的關聯：**
    *   **決策規則：**
        *   如果 $P \le \alpha$，則拒絕虛無假設 $H_0$。
        *   如果 $P > \alpha$，則不拒絕虛無假設 $H_0$。
    *   P 值與 $\alpha$ 提供了一種替代臨界值法來做出決策。

#### 1.6 型一錯誤 (Type I Error, $\alpha$)

*   **定義：** 當虛無假設 $H_0$ 事實上為真，但我們卻錯誤地拒絕了它。
*   **核心觀念：** 這是「誤報」或「偽陽性」的錯誤。我們預設了這種錯誤的最大容忍機率就是顯著水準 $\alpha$。
*   **例子：** 宣告一種無效的藥物有效。

#### 1.7 型二錯誤 (Type II Error, $\beta$)

*   **定義：** 當虛無假設 $H_0$ 事實上為假，但我們卻錯誤地沒有拒絕它。
*   **核心觀念：** 這是「漏報」或「偽陰性」的錯誤。
*   **例子：** 宣告一種有效的藥物無效。
*   **與相鄰概念的關聯：** 通常，減少型一錯誤（降低 $\alpha$）會增加型二錯誤（提高 $\beta$），反之亦然。這兩種錯誤之間存在權衡。

#### 1.8 檢定力 (Power, $1-\beta$)

*   **定義：** 檢定力是指在對立假設 $H_1$ 為真時，我們正確地拒絕虛無假設 $H_0$ 的機率。
*   **核心觀念：** 檢定力衡量了檢定捕捉到真實效應的能力，或者說，避免型二錯誤的能力。一個高檢定力的檢定能夠在對立假設為真時，更有可能發現這個真實的效應。
*   **與相鄰概念的關聯：** 檢定力受到樣本大小、顯著水準 $\alpha$ 和效應大小（Effect Size）的影響。增加樣本大小、提高顯著水準（但這會增加型一錯誤）或真實效應越大，通常會增加檢定力。

-----

### 2. 典型例子與步驟：單樣本 Z 檢定

假設檢定的一般步驟是所有不同類型檢定的通用框架。這裡我們以最基礎的「單樣本平均值 Z 檢定」為例。

#### 2.1 假設檢定的六個步驟

1.  **設定虛無假設 ($H_0$) 與對立假設 ($H_1$)：** 明確說明我們想要檢定的聲明。
2.  **選擇適合的顯著水準 ($\alpha$)：** 根據問題的重要性或可接受的風險程度來設定（例如 0.05 或 0.01）。
3.  **選擇適合的檢定方法與統計量：** 根據數據類型、樣本大小、總體標準差是否已知等因素選擇（例如 Z 檢定、t 檢定）。
4.  **計算檢定統計量：** 將樣本數據代入所選檢定統計量的公式中，得到一個數值。
5.  **決定拒絕域或計算 P 值：**
    *   **臨界值法：** 根據 $\alpha$ 和檢定統計量的抽樣分佈，找出臨界值，劃分出拒絕域。
    *   **P 值法：** 根據計算出的檢定統計量，找出其對應的 P 值。
6.  **做出決策並解釋結果：**
    *   **臨界值法：** 如果檢定統計量落在拒絕域內，則拒絕 $H_0$；否則，不拒絕 $H_0$。
    *   **P 值法：** 如果 $P \le \alpha$，則拒絕 $H_0$；否則，不拒絕 $H_0$。
    *   解釋決策在實際情境中的意義。

#### 2.2 單尾檢定與雙尾檢定 (One-tailed vs. Two-tailed Tests)

*   **雙尾檢定 (Two-tailed Test)：**
    *   對立假設聲明參數不等於某個值 (例如 $H_1: \mu \ne \mu_0$)。
    *   拒絕域分佈在抽樣分佈的兩端。
    *   $P$ 值需要考慮兩側的機率。
*   **單尾檢定 (One-tailed Test)：**
    *   對立假設聲明參數大於某個值 (例如 $H_1: \mu > \mu_0$) 或小於某個值 (例如 $H_1: \mu < \mu_0$)。
    *   拒絕域分佈在抽樣分佈的單一端。
    *   $P$ 值只需考慮單一側的機率。
*   **選擇時機：** 通常，如果研究者沒有預設立場，或者關注的是「是否存在差異」，則使用雙尾檢定。如果研究者明確預期了特定方向的差異（例如「新藥效果更好」），則使用單尾檢定。在商業應用中，通常建議先從雙尾檢定開始，除非有明確的理由支持單尾檢定。

#### 2.3 範例：Z 檢定

**情境：** 某飲料公司聲稱其產品的平均容量為 300 毫升。你懷疑實際容量可能有所不同。你隨機抽取了 36 瓶飲料，測得其平均容量為 298.5 毫升。已知該產品的容量標準差為 5 毫升。在顯著水準 $\alpha = 0.05$ 下，你是否有足夠證據質疑公司的聲明？

**解答步驟：**

1.  **設定虛無假設與對立假設：**
    *   $H_0: \mu = 300$ (平均容量為 300 毫升)
    *   $H_1: \mu \ne 300$ (平均容量不等於 300 毫升)
    *   這是一個雙尾檢定，因為我們懷疑「不同」，而不是特定方向的「大於」或「小於」。

2.  **選擇顯著水準：**
    *   $\alpha = 0.05$

3.  **選擇檢定方法與統計量：**
    *   由於樣本量 $n=36 > 30$（足夠大），且總體標準差 $\sigma=5$ 已知，因此使用 Z 檢定。
    *   檢定統計量：$Z = \frac{\bar{X} - \mu_0}{\sigma/\sqrt{n}}$

4.  **計算檢定統計量：**
    *   $\bar{X} = 298.5$
    *   $\mu_0 = 300$ (來自 $H_0$)
    *   $\sigma = 5$
    *   $n = 36$
    *   $Z = \frac{298.5 - 300}{5/\sqrt{36}} = \frac{-1.5}{5/6} = \frac{-1.5}{0.8333} \approx -1.80$

5.  **決定拒絕域 (使用臨界值法) 或計算 P 值 (使用 P 值法)：**

    *   **臨界值法 (以 Z 檢定為例)：**
        *   對於雙尾檢定，$\alpha = 0.05$，則兩側各分得 $\alpha/2 = 0.025$ 的機率。
        *   查標準常態分佈表，對應右尾機率 0.025 的 Z 值為 $1.96$。
        *   因此，臨界值為 $\pm 1.96$。
        *   拒絕域為 $Z < -1.96$ 或 $Z > 1.96$。

    *   **P 值法 (以 Z 檢定為例)：**
        *   計算出 $Z = -1.80$。
        *   由於是雙尾檢定，P 值為 $P(|Z| > |-1.80|) = P(Z > 1.80) + P(Z < -1.80)$。
        *   查標準常態分佈表，對應 $Z = 1.80$ 的右尾機率為 $0.0359$。
        *   因此，P 值 = $2 \times 0.0359 = 0.0718$。

6.  **做出決策並解釋結果：**

    *   **臨界值法：** 計算出的 $Z = -1.80$ 不在拒絕域 ($Z < -1.96$ 或 $Z > 1.96$) 內。
    *   **P 值法：** 計算出的 $P = 0.0718$ 大於 $\alpha = 0.05$。
    *   **結論：** 無論是使用臨界值法還是 P 值法，我們都**不拒絕虛無假設 $H_0$**。這意味著，在 $\alpha = 0.05$ 的顯著水準下，沒有足夠的統計證據質疑該飲料公司聲稱的平均容量為 300 毫升。觀察到的 298.5 毫升的樣本平均值，可能只是抽樣誤差造成的波動。

-----

### 3. 與相鄰概念的關聯

#### 3.1 假設檢定與信賴區間 (Confidence Intervals)

*   **關聯：** 假設檢定和信賴區間是統計推斷的兩種不同呈現方式，但它們本質上密切相關，並且通常會得出相同的結論。
*   **核心觀念：**
    *   **信賴區間：** 提供了一個總體參數的估計範圍，並附帶一個信賴水準（例如 95% 信賴區間表示有 95% 的信心，真實的總體參數落在這個區間內）。
    *   **假設檢定：** 評估關於總體參數的特定聲明。
*   **兩者聯繫：** 對於雙尾假設檢定，如果總體參數的 $(1-\alpha) \times 100\%$ 信賴區間不包含虛無假設中的參數值 ($\mu_0$)，那麼我們會在顯著水準 $\alpha$ 下拒絕虛無假設。反之，如果信賴區間包含 $\mu_0$，則我們不會拒絕 $H_0$。
*   **例子：** 在上面的飲料容量例子中，如果我們構建一個 95% 信賴區間：
    *   樣本平均值 $\bar{X} = 298.5$，標準誤差 $SE = \sigma/\sqrt{n} = 5/\sqrt{36} = 0.8333$。
    *   對於 95% 信賴區間，Z 臨界值為 $\pm 1.96$。
    *   信賴區間為 $\bar{X} \pm Z_{\alpha/2} \times SE = 298.5 \pm 1.96 \times 0.8333 \approx 298.5 \pm 1.63$。
    *   信賴區間是 $[296.87, 300.13]$。
    *   虛無假設的參數值 $\mu_0 = 300$ 包含在這個區間內。因此，我們不會拒絕 $H_0$，這與假設檢定的結論一致。

#### 3.2 假設檢定與點估計、區間估計

*   **點估計：** 使用樣本統計量（如樣本平均值 $\bar{X}$）來估計單一的總體參數值（如總體平均值 $\mu$）。
*   **區間估計：** 使用信賴區間來估計總體參數的範圍。
*   **關聯：** 假設檢定是建立在點估計和區間估計基礎之上的。點估計提供了我們檢定的「觀察值」，而區間估計則提供了與假設檢定結果相輔相成的對總體參數的範圍性理解。在檢定一個總體參數時，我們通常會先進行點估計，然後基於這個點估計來構建檢定統計量或信賴區間。

-----

### 4. 進階內容：檢定力分析簡介

#### 4.1 檢定力分析 (Power Analysis)

*   **定義：** 檢定力分析是在研究設計階段進行的一種統計分析，用來確定為達到預期的檢定力，需要多大的樣本量，或在給定樣本量、顯著水準和效應大小的情況下，能獲得多大的檢定力。
*   **核心觀念：** 檢定力分析是平衡型一錯誤和型二錯誤的關鍵工具。一個低檢定力的研究可能無法檢測到真實存在的效應，從而導致型二錯誤。
*   **應用場景：**
    *   **確定樣本量 (Sample Size Determination)：** 在研究開始前，根據預期的效應大小、顯著水準和目標檢定力（通常設為 0.80 或 0.90）來計算所需的最小樣本量。
    *   **評估已完成研究的檢定力 (Post-hoc Power Analysis)：** 在研究結束後，根據已有的數據和結果來計算實際的檢定力，以評估研究檢測真實效應的能力（但這種做法在解釋時需謹慎）。
    *   **比較不同研究設計：** 幫助選擇在有限資源下，能提供最高檢定力的實驗設計。
*   **影響檢定力的因素：**
    1.  **顯著水準 ($\alpha$)：** $\alpha$ 越大，檢定力越高（但型一錯誤風險也越大）。
    2.  **樣本大小 ($n$)：** 樣本大小越大，檢定力越高。
    3.  **效應大小 (Effect Size)：** 總體中真實存在的效應越大（例如新藥與舊藥的實際差異越大），檢定力越高。
    4.  **變異數 (Variance)：** 總體數據的變異數越小，檢定力越高。

-----

### 5. 常見錯誤與澄清

#### 5.1 不拒絕 $H_0$ 不代表 $H_0$ 為真

*   **錯誤觀念：** 「因為我們沒有拒絕 $H_0$，所以 $H_0$ 是真的。」
*   **澄清：** 假設檢定是一個基於證據的過程。不拒絕 $H_0$ 僅表示「**沒有足夠的證據來推翻 $H_0$**」，而不是說「**$H_0$ 被證明為真**」。想像法庭審判，如果證據不足以定罪，嫌疑人無罪釋放，這不代表嫌疑人一定是清白的，只是沒有足夠證據證明其有罪。這也與檢定力有關，如果檢定力太低，可能導致無法檢測到真實存在的效應。

#### 5.2 P 值不是 $H_0$ 為真的機率

*   **錯誤觀念：** 「P 值是虛無假設為真的機率。」或「P 值是檢定結果因巧合而發生的機率。」
*   **澄清：** P 值是「**在虛無假設為真的前提下，觀察到當前數據（或更極端的數據）的機率**」。它衡量的是數據與 $H_0$ 的不一致程度，而不是 $H_0$ 本身為真的機率。$P(數據 | H_0 為真) \ne P(H_0 為真 | 數據)$。

#### 5.3 統計顯著性不等於實質顯著性

*   **錯誤觀念：** 「只要統計上顯著（P < $\alpha$），這個結果就一定很重要、有意義。」
*   **澄清：** 統計顯著性僅表示觀察到的效應或差異不太可能是由隨機機會造成的。但即使一個非常小的、在實踐中毫無意義的差異，在足夠大的樣本量下，也可能達到統計顯著。**實質顯著性**或**臨床顯著性**則關乎效應的大小和其在現實世界中的重要性。在報告結果時，應同時考慮 P 值、效應大小（例如 Cohen's d、相關係數）和信賴區間，以提供更全面的理解。

#### 5.4 過度依賴 P 值

*   **錯誤觀念：** 「只要 P 值夠小，一切都好。」
*   **澄清：** P 值是決策的一個重要依據，但不應該是唯一依據。應結合研究設計、數據品質、樣本大小、效應大小、信賴區間以及領域知識來綜合判斷。僅報告 P 值而不提供效應大小和信賴區間，會使讀者難以評估結果的實際意義。近年來，統計學界越來越強調要超越 P < $\alpha$ 的二元決策，鼓勵更豐富的統計報告。

-----

### 6. 小練習（附詳解）

#### 小練習一：單樣本 t 檢定與 P 值解讀

**情境：** 某燈泡製造商聲稱其新型 LED 燈泡的平均壽命為 20000 小時。為了驗證此說法，一個獨立實驗室隨機抽取了 25 個新型 LED 燈泡進行壽命測試。測得樣本平均壽命為 19500 小時，樣本標準差為 1200 小時。假設燈泡壽命服從常態分佈。在顯著水準 $\alpha = 0.01$ 下，是否有足夠證據證明燈泡的平均壽命低於製造商的聲稱？

**詳解步驟：**

1.  **設定虛無假設與對立假設：**
    *   我們要檢定的是「平均壽命是否低於 20000 小時」。
    *   $H_0: \mu \ge 20000$ (平均壽命不低於 20000 小時)
    *   $H_1: \mu < 20000$ (平均壽命低於 20000 小時)
    *   這是一個左單尾檢定。

2.  **選擇顯著水準：**
    *   $\alpha = 0.01$

3.  **選擇檢定方法與統計量：**
    *   樣本量 $n=25$（較小），且總體標準差未知，只知道樣本標準差 $s=1200$。因此，使用 t 檢定。
    *   檢定統計量：$t = \frac{\bar{X} - \mu_0}{s/\sqrt{n}}$
    *   自由度 $df = n-1 = 25-1 = 24$。

4.  **計算檢定統計量：**
    *   $\bar{X} = 19500$
    *   $\mu_0 = 20000$ (來自 $H_0$)
    *   $s = 1200$
    *   $n = 25$
    *   $t = \frac{19500 - 20000}{1200/\sqrt{25}} = \frac{-500}{1200/5} = \frac{-500}{240} \approx -2.083$

5.  **決定拒絕域 (臨界值法) 或計算 P 值 (P 值法)：**

    *   **臨界值法：**
        *   對於左單尾檢定，$\alpha = 0.01$，自由度 $df = 24$。
        *   查 t 分佈表，右尾機率為 0.01 的 t 值約為 $2.492$。
        *   由於是左尾檢定，臨界值為 $-2.492$。
        *   拒絕域為 $t < -2.492$。

    *   **P 值法：**
        *   計算出的 $t = -2.083$，自由度 $df = 24$。
        *   由於是左單尾檢定，P 值為 $P(T < -2.083)$。
        *   查 t 分佈表或使用統計軟體，對於 $df=24$，當 $t=2.064$ 時，右尾機率約為 0.025；當 $t=2.492$ 時，右尾機率約為 0.01。
        *   因此，對於 $t=-2.083$，其左尾機率（P 值）介於 $0.01$ 和 $0.025$ 之間。更精確地說，P 值約為 $0.0233$。

6.  **做出決策並解釋結果：**

    *   **臨界值法：** 計算出的 $t = -2.083$ 不小於 $-2.492$，因此不落在拒絕域內。
    *   **P 值法：** 計算出的 $P \approx 0.0233$ 大於 $\alpha = 0.01$。
    *   **結論：** 無論是使用臨界值法還是 P 值法，我們都**不拒絕虛無假設 $H_0$**。在 $\alpha = 0.01$ 的顯著水準下，沒有足夠的統計證據證明這款 LED 燈泡的平均壽命低於 20000 小時。儘管樣本平均值略低，但這個差異可能只是隨機抽樣誤差造成的。

-----

#### 小練習二：P 值與顯著水準的選擇

**情境：** 一項研究聲稱，某地區成年人的平均體重是 70 公斤。你進行了一項調查，得到 P 值為 0.035。

1.  如果你的顯著水準 $\alpha = 0.05$，你會做出什麼決策？
2.  如果你的顯著水準 $\alpha = 0.01$，你會做出什麼決策？
3.  這個 P 值代表什麼？

**詳解步驟：**

1.  **當 $\alpha = 0.05$ 時的決策：**
    *   給定 P 值 $= 0.035$。
    *   比較 P 值與 $\alpha$：$0.035 \le 0.05$。
    *   **決策：** 由於 P 值小於或等於 $\alpha$，我們**拒絕虛無假設 $H_0$**。這表示在 5% 的顯著水準下，有足夠的統計證據表明該地區成年人的平均體重不等於 70 公斤。

2.  **當 $\alpha = 0.01$ 時的決策：**
    *   給定 P 值 $= 0.035$。
    *   比較 P 值與 $\alpha$：$0.035 > 0.01$。
    *   **決策：** 由於 P 值大於 $\alpha$，我們**不拒絕虛無假設 $H_0$**。這表示在 1% 的顯著水準下，沒有足夠的統計證據表明該地區成年人的平均體重不等於 70 公斤。

3.  **P 值 0.035 代表什麼：**
    *   在假設該地區成年人平均體重確實是 70 公斤的虛無假設為真的前提下，我們觀察到當前數據（或比它更極端數據）的機率是 0.035 (即 3.5%)。
    *   這個機率相對較低，但它並不是 $H_0$ 為真的機率。它只是告訴我們，如果 $H_0$ 成立，那麼我們得到這樣一個樣本結果會有多「不尋常」。

-----

### 7. 延伸閱讀 / 參考

假設檢定是統計學中一個廣闊的領域，上述內容僅涵蓋了最基礎和常見的概念。若要深入學習，建議參考以下主題和資源：

*   **不同檢定方法：**
    *   **t 檢定 (t-test)：** 適用於總體標準差未知，或小樣本的平均值比較。
        *   單樣本 t 檢定
        *   獨立樣本 t 檢定 (獨立兩組平均值比較)
        *   配對樣本 t 檢定 (同一組前後測比較)
    *   **Z 檢定 (Z-test)：** 適用於總體標準差已知，或大樣本的平均值、比例比較。
    *   **卡方檢定 (Chi-square test)：** 適用於類別變數的關聯性檢定（適合度檢定、獨立性檢定）。
    *   **變異數分析 (ANOVA)：** 適用於比較三個或更多組平均值的差異。
    *   **迴歸分析中的假設檢定：** 檢定迴歸係數的顯著性。
    *   **無母數檢定 (Non-parametric tests)：** 當數據不符合常態分佈等參數檢定假設時使用，例如 Mann-Whitney U 檢定、Wilcoxon 符號順序檢定、Kruskal-Wallis H 檢定。

*   **多重比較問題 (Multiple Comparisons Problem)：** 當進行多個假設檢定時，型一錯誤率會累積增加的問題，以及如何進行校正（例如 Bonferroni 校正、Tukey's HSD）。

*   **效應大小 (Effect Size)：** 了解不同效應大小指標（如 Cohen's d, $R^2$）的計算和解釋，以補充 P 值的不足。

*   **貝葉斯因子 (Bayes Factor)：** 另一種統計推斷方法，提供支持 $H_0$ 或 $H_1$ 的證據量，不同於頻率學派的假設檢定。

*   **推薦教材：**
    *   任何一本基礎統計學教科書，例如 David S. Moore 的《The Basic Practice of Statistics》、James McClave 的《Statistics》等。
    *   線上開放課程：Coursera、edX 等平台上的統計學課程。
    *   Khan Academy (可汗學院) 的統計學系列課程。