## 數位積體電路與 PLD 簡介

本章節將深入介紹數位積體電路 (Digital Integrated Circuits, DIC) 的基本概念，並探索可編程邏輯元件 (Programmable Logic Devices, PLD) 的原理、種類及其在現代電子設計中的應用。

-----

### 1. 數位積體電路 (Digital Integrated Circuits, DIC)

#### 1.1 核心概念與定義

數位積體電路是處理離散（通常是二進位）信號的電子電路。這些電路通常由大量的邏輯閘組成，這些邏輯閘實現了布林代數中的基本運算。

*   **數位訊號 (Digital Signal)：**
    *   **定義：** 一種在時間上和幅度上都離散的訊號。在二進位系統中，通常表示為高電壓（邏輯 1）和低電壓（邏輯 0）。
    *   **核心觀念：** 抗雜訊能力強，易於儲存和處理。
*   **邏輯閘 (Logic Gate)：**
    *   **定義：** 實現基本布林運算（AND, OR, NOT, NAND, NOR, XOR, XNOR）的電子電路。它們是數位電路的基本建構塊。
    *   **核心觀念：** 每個邏輯閘都有一個或多個輸入和一個輸出，其輸出狀態由輸入狀態根據其特定的邏輯功能決定。
*   **積體電路 (Integrated Circuit, IC)：**
    *   **定義：** 將大量電子元件（如電晶體、電阻、電容）整合到單一半導體基板上的微型電子裝置。
    *   **核心觀念：** 體積小、重量輕、功耗低、速度快、成本低、可靠性高。
*   **數位積體電路 (Digital Integrated Circuit, DIC)：**
    *   **定義：** 專門用於處理數位訊號的積體電路，由大量邏輯閘、觸發器、計數器等數位元件整合而成。
    *   **核心觀念：** 數位系統的核心，廣泛應用於電腦、通訊、控制等領域。

#### 1.2 數位積體電路的分類

DIC 通常根據其包含的邏輯閘數量進行分類，這也反映了其複雜度：

*   **SSI (Small-Scale Integration)：** 包含 1 到 10 個邏輯閘。例如：單個 AND 閘晶片、NOR 閘晶片。
*   **MSI (Medium-Scale Integration)：** 包含 10 到 100 個邏輯閘。例如：編碼器、解碼器、多工器、計數器、暫存器。
*   **LSI (Large-Scale Integration)：** 包含 100 到 10,000 個邏輯閘。例如：小型微處理器、儲存晶片。
*   **VLSI (Very Large-Scale Integration)：** 包含 10,000 到 1,000,000 個邏輯閘。例如：現代微處理器、大型記憶體晶片。
*   **ULSI (Ultra Large-Scale Integration)：** 包含超過 1,000,000 個邏輯閘。現代複雜的系統單晶片 (System-on-a-Chip, SoC)。

#### 1.3 典型例子與推導：布林函數到邏輯電路

布林代數是數位電路設計的數學基礎。任何數位邏輯功能都可以用布林表達式來描述，然後轉換為邏輯閘電路。

**例：實現一個簡單的加法器單元**

假設我們要設計一個電路，它有兩個輸入 $A, B$ 和一個輸出 $S$。當 $A \ne B$ 時 $S=1$，當 $A=B$ 時 $S=0$。這是一個 XOR (互斥或) 閘的功能。

1.  **真值表 (Truth Table)：**

    | $A$ | $B$ | $S$ |
    | :-- | :-- | :-- |
    | 0   | 0   | 0   |
    | 0   | 1   | 1   |
    | 1   | 0   | 1   |
    | 1   | 1   | 0   |

2.  **布林表達式 (Boolean Expression)：**
    從真值表中輸出為 1 的行，可以寫出：
    $S = (\bar{A} \cdot B) + (A \cdot \bar{B})$
    這就是 XOR 閘的定義表達式，常寫作 $S = A \oplus B$。

3.  **邏輯閘電路圖 (Logic Gate Circuit Diagram)：**
    ```
          +---+
    A ----|   |
          |XOR|---- S
    B ----|   |
          +---+
    ```
    或者使用 AND, OR, NOT 閘實現：
    ```
          +-----+
    A ----|NOT  |-----+
          +-----+     |
                      +---+
    B ----------------|AND|----+
                      +---+    |
                               |    +---+
    A -------------------------|----|OR |---- S
                               |    +---+
          +-----+              |
    B ----|NOT  |--------------|
          +-----+     +---+
    A ----------------|AND|----+
                      +---+
    ```

#### 1.4 與相鄰概念的關聯

*   **與類比積體電路 (Analog IC) 的區別：**
    *   **數位 IC：** 處理離散的數位訊號，主要關注邏輯功能和時序。對雜訊不敏感，易於設計和驗證。
    *   **類比 IC：** 處理連續的類比訊號，主要關注訊號的精確度、頻率響應、放大等。對雜訊敏感，設計較為複雜。
    *   **關聯：** 現代許多系統是混合訊號系統，需要同時使用數位 IC 和類比 IC，例如類比數位轉換器 (ADC) 和數位類比轉換器 (DAC)。
*   **與半導體製程的關聯：**
    *   DIC 的實現離不開半導體製程技術，如 CMOS (互補金屬氧化物半導體) 或 TTL (電晶體-電晶體邏輯)。
    *   CMOS 是目前主流的技術，因其低功耗和高密度集成能力。這些製程技術決定了邏輯閘的性能、功耗和尺寸。
*   **為 PLD 奠定基礎：**
    *   DIC 屬於「固定功能」電路，一旦製造完成，其邏輯功能就無法改變。
    *   PLD 的出現就是為了解決 DIC 彈性不足的問題，允許用戶在製造後「編程」其邏輯功能。

-----

### 2. 可編程邏輯元件 (Programmable Logic Devices, PLD)

#### 2.1 核心概念與定義

可編程邏輯元件 (PLD) 是一種特殊的數位積體電路，其邏輯功能可以在製造後由使用者進行配置或「編程」。PLD 的出現極大地提高了數位系統設計的靈活性和開發效率。

*   **定義：** 一種內部邏輯功能未完全固定的積體電路，允許設計者透過特定的編程方式來實現所需的邏輯功能。
*   **核心觀念：** PLD 本質上是一系列可配置的邏輯閘和互連線路，使用者可以透過燒錄或配置記憶體來改變這些連接，從而實現不同的邏輯功能。

#### 2.2 PLD 的演進與主要種類

PLD 技術經歷了數十年的發展，從簡單的可編程陣列發展到複雜的現場可編程閘陣列。

1.  **PROM (Programmable Read-Only Memory)：**
    *   **定義：** 最早的可編程邏輯元件之一，主要用於儲存數據或實現簡單的組合邏輯。其特點是具有固定的 AND 陣列（解碼器）和可編程的 OR 陣列。
    *   **核心觀念：** 只能燒錄一次 (OTP, One-Time Programmable) 或可擦寫 (EPROM, EEPROM)。所有可能的輸入組合都有一個解碼器輸出，然後這些輸出可以選擇性地連接到 OR 閘，形成輸出函數。

2.  **PLA (Programmable Logic Array)：**
    *   **定義：** 具有可編程的 AND 陣列和可編程的 OR 陣列。這意味著設計者可以定義哪些積項 (product terms) 是需要的，以及這些積項如何組合成輸出。
    *   **核心觀念：** 較 PROM 彈性更大，因為 AND 陣列也是可編程的，可以減少冗餘積項。但通常比 PAL 更複雜且成本更高。

3.  **PAL (Programmable Array Logic)：**
    *   **定義：** 具有可編程的 AND 陣列和固定的 OR 陣列。
    *   **核心觀念：** 簡化了 PLA 的結構，使其成本更低且易於編程。每個 OR 閘的輸入積項數量是固定的。通常包含輸出觸發器，可以實現序向邏輯。

4.  **CPLD (Complex Programmable Logic Device)：**
    *   **定義：** 由多個 PAL-like 結構（稱為宏單元或邏輯區塊）通過可編程互連矩陣連接而成的元件。
    *   **核心觀念：** 介於 PAL 和 FPGA 之間，提供更多的邏輯閘和更複雜的功能。其配置資訊通常儲存在非揮發性記憶體中，因此上電後可立即工作。

5.  **FPGA (Field-Programmable Gate Array)：**
    *   **定義：** 具有大量可配置邏輯單元 (Configurable Logic Blocks, CLB)、可編程互連資源和輸入/輸出區塊的複雜 PLD。
    *   **核心觀念：** 提供極高的邏輯閘數量和極大的設計彈性，可以實現非常複雜的數位系統，甚至整個 SoC。FPGA 的配置通常儲存在揮發性記憶體中（如 SRAM），因此需要外部記憶體在每次上電時載入配置。

#### 2.3 典型例子與推導：PLD 的內部結構與布林函數映射

**以 PAL 為例，實現布林函數 $F = (A \cdot \bar{B}) + (\bar{A} \cdot C)$**

PAL 的基本結構包含一個可編程的 AND 陣列和一個固定的 OR 陣列。

1.  **輸入緩衝與反相：**
    輸入 $A, B, C$ 首先經過緩衝器和反相器，產生 $A, \bar{A}, B, \bar{B}, C, \bar{C}$。這些稱為「字線 (word lines)」。

2.  **可編程 AND 陣列：**
    *   AND 陣列由一系列 AND 閘組成。每個 AND 閘的輸入來自字線，這些連接是可編程的 (通常透過熔絲或開關陣列)。
    *   為了實現 $F = (A \cdot \bar{B}) + (\bar{A} \cdot C)$，我們需要兩個積項：$P_1 = A \cdot \bar{B}$ 和 $P_2 = \bar{A} \cdot C$。
    *   配置第一個 AND 閘，使其輸入連接到 $A$ 和 $\bar{B}$。
    *   配置第二個 AND 閘，使其輸入連接到 $\bar{A}$ 和 $C$。
    *   這些 AND 閘的輸出稱為「積項線 (product term lines)」。

3.  **固定 OR 陣列：**
    *   OR 陣列由一系列 OR 閘組成。每個 OR 閘的輸入來自積項線，這些連接是固定的。
    *   假設我們的 PAL 中有一個 OR 閘，我們可以將 $P_1$ 和 $P_2$ 的積項線連接到這個 OR 閘的輸入，其輸出即為 $F = P_1 + P_2 = (A \cdot \bar{B}) + (\bar{A} \cdot C)$。

**概念性結構圖 (簡化)：**

```
            輸入緩衝器/反相器
            +-------------------+
    A ------| A   / A_bar     |
    B ------| B   / B_bar     |
    C ------| C   / C_bar     |
            +-------------------+
                    |
                    V
        可編程 AND 陣列 (熔絲/開關)
        +-----------------------------------+
        |      AND Gate 1                   |  <-- 連接 A 和 B_bar
        |      AND Gate 2                   |  <-- 連接 A_bar 和 C
        |      ...                          |
        +-----------------------------------+
                    |
                    V
         固定 OR 陣列
        +-----------------------------------+
        |      OR Gate 1 (F)                |  <-- 連接 AND Gate 1 和 AND Gate 2 的輸出
        |      ...                          |
        +-----------------------------------+
                    |
                    V
                   輸出 F
```

#### 2.4 與相鄰概念的關聯

*   **PLD 與傳統固定功能 IC 的對比：**
    *   **固定功能 IC (DIC)：** 功能預先決定，生產成本低（大量生產），性能優異。但設計週期長，NRE (Non-Recurring Engineering) 成本高，上市時間長，一旦設計錯誤則需重新開模。
    *   **PLD：** 功能可編程，設計週期短，NRE 成本低，上市時間快，設計彈性高，可現場更新。但單個晶片成本通常較高，性能可能略遜於同等級的 ASIC。
    *   **關聯：** PLD 填補了 DIC 在原型開發、中小批量生產和快速迭代方面的空白。
*   **PLD 與 ASIC (Application-Specific Integrated Circuit) 的對比：**
    *   **ASIC：** 針對特定應用設計的專用 IC，提供最佳的性能、功耗和尺寸，但開發成本極高、週期極長。
    *   **PLD (尤其是 FPGA)：** 可現場編程，靈活性高，開發成本和時間較低。適合快速原型開發、小批量生產和需要彈性升級的產品。
    *   **關聯：** 對於複雜系統，FPGA 常作為 ASIC 的原型驗證平台，或用於小批量產品。當產品量達到一定規模時，可能會從 FPGA 轉換為 ASIC 以降低單位成本並提升性能。
*   **硬體描述語言 (HDL) 與 PLD 編程：**
    *   **HDL (Hardware Description Language)：** 如 VHDL (VHSIC Hardware Description Language) 和 Verilog，是描述數位電路行為和結構的程式語言。
    *   **PLD 編程：** 現代 PLD（特別是 CPLD 和 FPGA）的設計流程主要透過 HDL 描述電路，然後使用綜合工具 (Synthesis Tool) 將 HDL 程式碼轉換成邏輯閘網表，再由映射、佈局和路由工具 (Place & Route Tool) 將網表映射到 PLD 的內部結構上，生成配置檔案 (bitstream)，最後載入到 PLD 中。
    *   **關聯：** HDL 是 PLD 設計的核心工具，使得設計者無需手動繪製邏輯閘，就能高效地設計複雜的數位系統。

-----

### 3. 常見錯誤與澄清

1.  **錯誤：CPLD 和 FPGA 是一回事。**
    *   **澄清：** 儘管都屬於 PLD，但 CPLD 和 FPGA 在結構、容量和應用場景上有所不同。CPLD 具有較少的邏輯單元，互連結構更為剛性，且通常為非揮發性記憶體配置。FPGA 具有大量的邏輯單元，高度彈性的互連結構，且多為揮發性記憶體配置（需外部配置記憶體）。CPLD 更適合於膠合邏輯和簡單的狀態機，而 FPGA 則適用於高度複雜的數位訊號處理、平行運算等。
2.  **錯誤：PLD 性能一定比固定功能 IC 差。**
    *   **澄清：** 不完全是。對於簡單功能，高性能的 CPLD 或小型 FPGA 可能會比多個固定功能 SSI/MSI IC 組合起來更快。但對於非常複雜、大規模的功能，專門設計的 ASIC 通常能達到更高的時脈頻率和更低的功耗，因為它們是為特定功能優化的。PLD 的通用性和可重構性帶來了一定的性能開銷。
3.  **錯誤：PLD 編程就像寫軟體一樣，是設計軟體。**
    *   **澄清：** 雖然使用 HDL 語言（如 VHDL, Verilog）來描述設計，其語法與程式語言相似，但 PLD 設計本質上是**硬體設計**。HDL 程式碼描述的是電路的並行行為和硬體結構，而不是指令序列。綜合工具會將這些描述轉換成物理電路。軟體是循序執行指令，而硬體則是同時並行運作。

-----

### 4. 小練習

#### 4.1 小練習一：組合邏輯電路設計

**題目：**
設計一個數位電路，有三個輸入 $A, B, C$，一個輸出 $F$。當且僅當輸入有奇數個 1 時，輸出 $F$ 為 1。

**步驟：**

1.  **繪製真值表：** 列出所有可能的輸入組合及其對應的輸出。
2.  **寫出布林表達式 (Sum of Products, SOP)：** 根據真值表中輸出為 1 的行，寫出 SOP 形式的布林表達式。
3.  **繪製邏輯電路圖：** 使用 AND 閘、OR 閘和 NOT 閘來實現該布林表達式。

**詳解：**

1.  **真值表：**

    | $A$ | $B$ | $C$ | $F$ |
    | :-- | :-- | :-- | :-- |
    | 0   | 0   | 0   | 0   |
    | 0   | 0   | 1   | 1   |
    | 0   | 1   | 0   | 1   |
    | 0   | 1   | 1   | 0   |
    | 1   | 0   | 0   | 1   |
    | 1   | 0   | 1   | 0   |
    | 1   | 1   | 0   | 0   |
    | 1   | 1   | 1   | 1   |

2.  **布林表達式 (SOP)：**
    從真值表中 $F=1$ 的行，可以得到：
    $F = (\bar{A} \cdot \bar{B} \cdot C) + (\bar{A} \cdot B \cdot \bar{C}) + (A \cdot \bar{B} \cdot \bar{C}) + (A \cdot B \cdot C)$
    這個表達式其實就是三輸入的 XOR 函數：$F = A \oplus B \oplus C$。

3.  **邏輯電路圖：**
    使用兩個 XOR 閘實現：
    ```
          +---+
    A ----|   |
          |XOR|----+
    B ----|   |    |    +---+
          +---+    |----|   |
                   |    |XOR|---- F
                   |----|   |
    C ------------------+---+
    ```

    如果使用 AND, OR, NOT 閘實現原始 SOP 表達式，電路會較為複雜：
    ```
            +-----+
      A ----|NOT  |-----+
            +-----+     |
                        +-----+
      B ----|NOT  |-----|AND  |-----+
            +-----+     +-----+     |
            C ----------------------|
                                    |
            +-----+                 |
      A ----|NOT  |-----------------|
            +-----+                 |
      B ----------------------------|
            +-----+                 |
      C ----|NOT  |-----|AND  |-----|
            +-----+     +-----+     |
            +-----+                 |
      A ----------------------------|
            +-----+                 |
      B ----|NOT  |-----|AND  |-----|
            +-----+     +-----+     |
            C ----------------------|
                                    |
      A ----------------------------|
      B ----------------------------|
      C ----------------|AND  |-----|
                        +-----+     |
                                    |
                                  +---+
                                  |OR |---- F
                                  +---+
    ```
    (註：為簡潔，此圖未畫出所有 AND 閘的完整連線，但概念是將所有積項 AND 閘的輸出連接到一個最終的 OR 閘。)

#### 4.2 小練習二：PLD 基本概念應用

**題目：**
給定一個布林函數 $G = (X + Y) \cdot \bar{Z}$，請說明如何在概念上將其映射到一個簡單的 PLA (Programmable Logic Array) 結構上。請指出 PLA 中哪些部分是可編程的。

**詳解：**

1.  **展開為積之和 (SOP) 形式或和之積 (POS) 形式：**
    PLA 可以直接實現 SOP 形式，也可以透過德摩根定律等轉換為 SOP。
    $G = (X + Y) \cdot \bar{Z} = (X \cdot \bar{Z}) + (Y \cdot \bar{Z})$
    現在函數為 SOP 形式，包含兩個積項：$P_1 = X \cdot \bar{Z}$ 和 $P_2 = Y \cdot \bar{Z}$。

2.  **PLA 結構簡述：**
    PLA 由一個可編程的 AND 陣列和一個可編程的 OR 陣列組成。
    *   **輸入緩衝器：** 將輸入 $X, Y, Z$ 轉換為其本身和反相形式 $X, \bar{X}, Y, \bar{Y}, Z, \bar{Z}$。
    *   **可編程 AND 陣列：** 負責產生所需的積項。
    *   **可編程 OR 陣列：** 負責將所需的積項組合起來，形成最終的輸出。

3.  **映射到 PLA：**
    *   **配置 AND 陣列：**
        *   為第一個積項 $P_1 = X \cdot \bar{Z}$，在 AND 陣列中選擇一個 AND 閘。將此 AND 閘的輸入線連接到 $X$ 和 $\bar{Z}$ （將其他輸入線斷開）。
        *   為第二個積項 $P_2 = Y \cdot \bar{Z}$，在 AND 陣列中選擇另一個 AND 閘。將此 AND 閘的輸入線連接到 $Y$ 和 $\bar{Z}$ （將其他輸入線斷開）。
    *   **配置 OR 陣列：**
        *   為輸出 $G$，在 OR 陣列中選擇一個 OR 閘。將此 OR 閘的輸入線連接到前面產生的積項 $P_1$ 和 $P_2$ 的輸出線（將其他積項線斷開）。

4.  **可編程部分：**
    *   **AND 陣列：** AND 閘的輸入連接是可編程的。這允許設計者決定哪些輸入變量及其反相形式會形成特定的積項。
    *   **OR 陣列：** OR 閘的輸入連接是可編程的。這允許設計者決定哪些積項會被 OR 起來，形成最終的輸出函數。

PLA 的靈活性在於兩個陣列都可編程，能夠更有效地利用資源來實現複雜的布林函數。

-----

### 5. 延伸閱讀

*   **數位邏輯設計 (Digital Logic Design)：** 學習布林代數、組合邏輯、序向邏輯等基本原理。
    *   M. Morris Mano & Michael D. Ciletti, "Digital Design: With an Introduction to the Verilog HDL, VHDL, and SystemVerilog" (中文譯本：數位邏輯設計).
*   **FPGA 基礎與應用：** 深入了解 FPGA 的架構、設計流程和應用案例。
    *   Samir Palnitkar, "Verilog HDL: A Guide to Digital Design and Synthesis" (或VHDL相關書籍)。
*   **半導體製程概論：** 了解積體電路是如何製造的。
    *   Richard C. Jaeger, "Microelectronic Circuit Design".
*   **線上資源：**
    *   **Coursera / edX：** 搜尋 "Digital Logic" 或 "FPGA Design" 等課程。
    *   **各大學開放課程：** 例如 MIT 的 6.004 Computation Structures (計算結構)。
    *   **PLD 廠商網站：** 如 Xilinx (現 AMD Adaptive Computing Group)、Intel (Altera) 等，提供大量教學資源、應用筆記和開發工具。